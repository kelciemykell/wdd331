(()=>{"use strict";var e,t,n,r,i,a={65207:(e,t,n)=>{n(47594);var r=n(80923),i=(n(21201),n(38648)),a=(n(3991),n(55026)),o=n(67294),s=n(73935),l=(n(41514),n(9676)),c=n(94184),u=n.n(c),d=n(85893);function h(e){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function m(e,t,n){return t&&f(e.prototype,t),n&&f(e,n),e}function v(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&g(e,t)}function g(e,t){return(g=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=x(e);if(t){var i=x(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b(this,n)}}function b(e,t){return!t||"object"!==h(t)&&"function"!=typeof t?j(e):t}function j(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function x(e){return(x=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var w=function(e){v(n,e);var t=y(n);function n(e){return p(this,n),t.call(this,e)}return m(n,[{key:"shouldComponentUpdate",value:function(e){return e.disabled!==this.props.disabled||this.props.allowAdvancedTool!==e.allowAdvancedTool}},{key:"render",value:function(){var e=this.props,t=e.disabled,n=e.action,r=e.title,i=e.handleClick,a=u()("tool-btn single-btn",{disabled:t}),o=u()(this.props.allowAdvancedTool?"":"pro");return(0,d.jsx)("div",{className:a,"data-action":n,onClick:i.bind(this,"action",{actionType:n}),title:r,children:(0,d.jsx)("b",{className:o})})}}]),n}(o.Component),S=function(e){v(n,e);var t=y(n);function n(e){return p(this,n),t.call(this,e)}return m(n,[{key:"shouldComponentUpdate",value:function(e){return e.current!==this.props.current||this.props.allowAdvancedTool!==e.allowAdvancedTool}},{key:"render",value:function(){var e=this.props,t=e.current,n=e.shape,r=e.title,i=e.handleClick,a=u()("tool-btn single-btn",{active:t===n}),o=u()(this.props.allowAdvancedTool?"":"pro");return(0,d.jsx)("div",{className:a,"data-shape":n,onClick:i.bind(this,"shape",n),title:r,children:(0,d.jsx)("b",{className:o})})}}]),n}(o.Component),C=function(e){v(n,e);var t=y(n);function n(e){var r;return p(this,n),(r=t.call(this,e)).state={currentBtn:r.props.btns[0]},r.handleDropDownBtnClick=r.handleDropDownBtnClick.bind(j(r)),r}return m(n,[{key:"shouldComponentUpdate",value:function(e,t){return t.currentBtn!==this.state.currentBtn||e.current!==this.props.current}},{key:"handleDropDownBtnClick",value:function(e){this.setState({currentBtn:e}),this.props.handleClick("shape",e.shape)}},{key:"render",value:function(){var e=this,t=this.state.currentBtn,n=this.props.btns;return(0,d.jsxs)("div",{className:"tool-btn multi-btn",children:[(0,d.jsx)(S,{title:t.title,shape:t.shape,current:this.props.current,handleClick:this.props.handleClick}),(0,d.jsx)(k,{children:function(t,r){var i=u()("multi-btn-dropdown",{active:t.isExpand}),a=function(t){r(),e.handleDropDownBtnClick(t)};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("div",{className:"multi-btn-arrow"}),(0,d.jsx)("div",{className:i,children:n.map((function(e){return(0,d.jsx)("div",{className:"tool-btn sub-single-btn","data-shape":e.shape,onClick:a.bind(null,e),children:(0,d.jsx)("b",{})},e.shape)}))})]})}})]})}}]),n}(o.Component),k=function(e){v(n,e);var t=y(n);function n(e){var r;return p(this,n),(r=t.call(this,e)).state={isExpand:!1},r.toggle=r.toggle.bind(j(r)),r.el=(0,o.createRef)(),r}return m(n,[{key:"shouldComponentUpdate",value:function(e,t){return!0}},{key:"toggle",value:function(){this.state.isExpand&&this.el.current.blur(),this.setState({isExpand:!this.state.isExpand})}},{key:"render",value:function(){var e=u()("tool-select",this.props.className);return(0,d.jsx)("div",{className:e,tabIndex:"0",onFocus:this.toggle,onBlur:this.toggle,ref:this.el,children:this.props.children(this.state,this.toggle)})}}]),n}(o.Component),N=n(6700);function O(e){return(O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function D(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function I(e,t){return(I=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Z(e);if(t){var i=Z(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return P(this,n)}}function P(e,t){return!t||"object"!==O(t)&&"function"!=typeof t?A(e):t}function A(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Z(e){return(Z=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var U=["rgb(255, 0, 0)","rgb(152, 0, 0)","rgb(255, 153, 0)","rgb(255, 255, 0)","rgb(0, 255, 0)","rgb(0, 0, 0)","rgb(67, 67, 67)","rgb(102, 102, 102)","rgb(153, 153, 153)","rgb(183, 183, 183)","rgb(204, 204, 204)","rgb(217, 217, 217)","rgb(239, 239, 239)","rgb(243, 243, 243)","rgb(255, 255, 255)","rgb(0, 255, 255)","rgb(74, 134, 232)","rgb(0, 0, 255)","rgb(153, 0, 255)","rgb(255, 0, 255)","rgb(230, 184, 175)","rgb(244, 204, 204)","rgb(252, 229, 205)","rgb(255, 242, 204)","rgb(217, 234, 211)","rgb(208, 224, 227)","rgb(201, 218, 248)","rgb(207, 226, 243)","rgb(217, 210, 233)","rgb(234, 209, 220)","rgb(221, 126, 107)","rgb(234, 153, 153)","rgb(249, 203, 156)","rgb(255, 229, 153)","rgb(182, 215, 168)","rgb(162, 196, 201)","rgb(164, 194, 244)","rgb(159, 197, 232)","rgb(180, 167, 214)","rgb(213, 166, 189)","rgb(204, 65, 37)","rgb(224, 102, 102)","rgb(246, 178, 107)","rgb(255, 217, 102)","rgb(147, 196, 125)","rgb(118, 165, 175)","rgb(109, 158, 235)","rgb(111, 168, 220)","rgb(142, 124, 195)","rgb(194, 123, 160)","rgb(166, 28, 0)","rgb(204, 0, 0)","rgb(230, 145, 56)","rgb(241, 194, 50)","rgb(106, 168, 79)","rgb(69, 129, 142)","rgb(60, 120, 216)","rgb(61, 133, 198)","rgb(103, 78, 167)","rgb(166, 77, 121)","rgb(133, 32, 12)","rgb(153, 0, 0)","rgb(180, 95, 6)","rgb(191, 144, 0)","rgb(56, 118, 29)","rgb(19, 79, 92)","rgb(17, 85, 204)","rgb(11, 83, 148)","rgb(53, 28, 117)","rgb(116, 27, 71)","rgb(91, 15, 0)","rgb(102, 0, 0)","rgb(120, 63, 4)","rgb(127, 96, 0)","rgb(39, 78, 19)","rgb(12, 52, 61)","rgb(28, 69, 135)","rgb(7, 55, 99)","rgb(32, 18, 77)","rgb(76, 17, 48)"],E=[2,4,6,8,16],R=[14,18,24,36,48],_=[{title:"Rectangle",shape:"rect"},{title:"Ellipse",shape:"ellipse"}],F=[{title:"Line Arrow",shape:"line_arrow"},{title:"Bezier Arrow",shape:"bezier_arrow"},{title:"Line",shape:"line"},{title:"Big Head Arrow",shape:"big_head_arrow"}],M=["Times New Roman","Arial","Craft Girls","Limelight","Lobster","Anton","Chewy","Frijole","Spirax","Dancing Script","Changa One","Griffy"],L=["windows-cursor","cursor","cursor-hand","cursor-hand-black","cursor-click","smile","cry","tick-off","cross","forbidden","warning","q-mark","like","heart","star","chicken","dog","rain","sun","cloud","thunder","fish","fish2","tree1","tree2","building1","building2","package","tent","umbrella","car","basketball","beer"];const B=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&I(e,t)}(a,e);var t,n,r,i=T(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,e)).handleCropDemensionChange=t.handleCropDemensionChange.bind(A(t)),t}return t=a,(n=[{key:"handleCropDemensionChange",value:function(e,t){""===t.target.value&&(t.target.value=0),this.props.handleToolBarBtnClick("action",{actionType:"crop-demension-"+e,value:t.target.value})}},{key:"render",value:function(){var e=this,t=this.props,n=t.handleToolBarBtnClick,r=t.handleResizeInputChange,i=t.handleResizeProportionChange,a=t.getResizeInfo,o=t.currentTool,s=t.currentScale,c=t.isShowScaleTip,h=t.cropWidth,p=t.cropHeight,f=t.resizeWidth,m=t.resizeHeight,v=t.resizeProportional,g=t.canUndo,y=t.canRedo,b=t.canClear,j=t.canDeleteSelected,x=t.finishEdit,O=t.isTextBackground,D=t.handleTextBgChange,I=t.handleResetList,T=100*s+"%";u()("zoom-tip",{active:c});return(0,d.jsx)("div",{className:"toolbar active",children:this.props.isInCropMode?(0,d.jsxs)("div",{className:"crop-area",children:[(0,d.jsx)("div",{className:"tool-action-btn primary-btn",id:"crop-btn",onClick:n.bind(e,"action",{actionType:"doCrop"}),children:"Crop"}),(0,d.jsx)("div",{className:"tool-action-btn",id:"crop-cancel-btn",onClick:n.bind(e,"action",{actionType:"leaveCrop"}),children:"Cancel"}),(0!==h||0!==p)&&(0,d.jsxs)("div",{id:"crop-dimension",children:[(0,d.jsxs)("div",{children:["Width:",(0,d.jsx)("input",{type:"text",id:"cd-width",className:"cd-input",onChange:e.handleCropDemensionChange.bind(null,"width"),value:h})]}),(0,d.jsxs)("div",{children:["Height:",(0,d.jsx)("input",{id:"cd-height",type:"text",className:"cd-input",onChange:e.handleCropDemensionChange.bind(null,"height"),value:p})]})]})]}):(0,d.jsxs)("div",{className:"tools",children:["ext"!==e.props.type&&(0,d.jsx)("div",{className:"back-btn",onClick:e.props.handleBack,children:(0,d.jsx)(N.Z,{})}),(0,d.jsx)(k,{className:"resize",children:function(e,t){var o=u()("panel",{active:e.isExpand});return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("div",{className:"tool-btn resize-btn",id:"resize-btn",onClick:a,children:(0,d.jsx)("b",{})}),(0,d.jsxs)("div",{className:o,children:[(0,d.jsxs)("div",{className:"row",children:[(0,d.jsx)("span",{children:"Width:"}),(0,d.jsx)("input",{type:"number",id:"resize-width",min:"1",max:"5000",value:f,onChange:r.bind(null,"width")}),"px"]}),(0,d.jsxs)("div",{className:"row",children:[(0,d.jsx)("span",{children:"Height:"}),(0,d.jsx)("input",{type:"number",id:"resize-height",min:"1",max:"5000",value:m,onChange:r.bind(null,"height")}),"px"]}),(0,d.jsx)("div",{className:"row",children:(0,d.jsx)("label",{htmlFor:"resize-proportional",children:(0,d.jsx)(l.Z,{checked:v,onChange:i,children:"Proportional"})})}),(0,d.jsxs)("div",{className:"row",children:[(0,d.jsx)("div",{className:"do-resize-btn",id:"do-resize-btn",onClick:function(e){t(),n("action",{actionType:"doResize"})},children:"Resize"}),(0,d.jsx)("div",{className:"resize-cancel",id:"resize-cancel",onClick:t,children:"Cancel"})]})]})]})}}),(0,d.jsx)(w,{title:"Crop",action:"crop",handleClick:n}),(0,d.jsx)("div",{className:"tool-sep"}),(0,d.jsx)(S,{title:"Pen",shape:"curve",current:o,handleClick:n}),(0,d.jsx)(C,{btns:_,current:o,handleClick:n}),(0,d.jsx)(C,{btns:F,current:o,handleClick:n}),(0,d.jsx)(S,{title:"Text",shape:"Text",current:o,handleClick:n}),(0,d.jsx)(S,{title:"Blur",shape:"rect_blur",current:o,handleClick:n}),(0,d.jsx)(S,{title:"Highlight",shape:"highlight",current:o,handleClick:n}),(0,d.jsxs)("div",{className:"advanced-tool",children:[(0,d.jsx)(S,{title:"Callout",shape:"callout",current:o,handleClick:n,allowAdvancedTool:e.props.allowAdvancedTool}),(0,d.jsx)(S,{title:"Step",shape:"list",current:o,handleClick:n,allowAdvancedTool:e.props.allowAdvancedTool}),(0,d.jsx)(k,{className:"tool-image-picker",children:function(t,r){var i=u()("panel",{active:t.isExpand}),a=function(e){r(),n("action",{actionType:"doInsertImage",value:e})},o=u()(e.props.allowAdvancedTool?"":"pro");return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{className:"image-btn",id:"image-btn",children:[(0,d.jsx)("b",{className:o}),(0,d.jsx)("div",{className:"image-btn-arrow"})]}),(0,d.jsx)("div",{className:i,children:(0,d.jsx)("div",{className:"panel-container",children:L.map((function(t,n){if("web"===e.props.type)var r="/images/svg/"+t+".svg";else r="./images/svg/"+t+".svg";return(0,d.jsx)("div",{className:"image-item",onClick:a.bind(null,t),children:(0,d.jsx)("img",{src:r,alt:""})},t)}))})})]})}}),(0,d.jsx)(w,{title:"Image",action:"insert-image",handleClick:n,allowAdvancedTool:e.props.allowAdvancedTool})]}),(0,d.jsx)("div",{className:"tool-sep"}),(0,d.jsx)(k,{className:"tool-color-picker multi-btn",children:function(t,r){var i=u()("panel",{active:t.isExpand}),a=function(e){r(),n("action",{actionType:"changeColor",value:e})};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("div",{className:"tool-current-color current",id:"tool-current-color",style:{backgroundColor:e.props.currentColor},"data-color":e.props.currentColor}),(0,d.jsx)("div",{className:"multi-btn-arrow"}),(0,d.jsx)("div",{className:i,children:U.map((function(t){return(0,d.jsx)("div",{className:"color-item","data-color":t,style:{backgroundColor:t,borderColor:(n=t,"rgb(239, 239, 239)"===n||"rgb(243, 243, 243)"===n||"rgb(255, 255, 255)"===n||"rgb(252, 229, 205)"===n||"rgb(255, 242, 204)"===n?"#bdc1c6":"transparent")},onClick:a.bind(e,t)},t);var n}))})]})}}),(u()("zoom-tip",{active:c}),function(){if("Text"===o){var t=O?"bg":"";return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(k,{className:"tool-font-family multi-btn",children:function(t,n){var r=u()("panel",{active:t.isExpand}),i=function(t){n(),e.props.handleToolBarBtnClick("action",{actionType:"changeFontFamily",value:t})};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{className:"tool-current-font-family current",id:"tool-current-font-family","data-ff":e.props.currentFontFamily,children:[(0,d.jsx)("span",{children:e.props.currentFontFamily}),(0,d.jsx)("div",{className:"btn-down-arrow"})]}),(0,d.jsx)("div",{className:r,children:M.map((function(t){return(0,d.jsx)("div",{className:"font-f-item","data-ff":t,onClick:i.bind(e,t),children:t},t)}))})]})}}),(0,d.jsx)(k,{className:"tool-font-size multi-btn",children:function(t,n){var r=u()("panel",{active:t.isExpand}),i=function(t){n(),e.props.handleToolBarBtnClick("action",{actionType:"changeFontSize",value:t})};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{className:"tool-current-font-size current","data-fs":e.props.currentFontSize,id:"tool-current-font-size",children:[e.props.currentFontSize,"px",(0,d.jsx)("div",{className:"btn-down-arrow"})]}),(0,d.jsx)("div",{className:r,children:R.map((function(t){return(0,d.jsxs)("div",{className:"font-s-item","data-fs":t,onClick:i.bind(e,t),children:[t,"px"]},t)}))})]})}}),(0,d.jsx)("div",{className:"single-btn text-bg-option-btn ".concat(t),onClick:D,children:(0,d.jsx)("span",{children:"A"})})]})}return"list"===o?(0,d.jsx)("div",{className:"tool-select tool-restart-sequence",children:(0,d.jsx)("div",{onClick:I,children:"Restart Sequence"})}):(0,d.jsx)(k,{className:"tool-pen-width multi-btn",children:function(t,n){var r=u()("panel",{active:t.isExpand}),i=function(t){n(),e.props.handleToolBarBtnClick("action",{actionType:"changePenWidth",value:t})};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{className:"current",id:"tool-current-width","data-width":e.props.currentPenWidth,children:[(0,d.jsxs)("div",{className:"tool-current-width",children:[(0,d.jsxs)("span",{children:[e.props.currentPenWidth,"px"]}),(0,d.jsx)("b",{})]}),(0,d.jsx)("div",{className:"btn-down-arrow"})]}),(0,d.jsx)("div",{className:r,children:E.map((function(t){return(0,d.jsxs)("div",{className:"pen-width-item","data-width":t,onClick:i.bind(e,t),children:[(0,d.jsxs)("span",{children:[t,"px"]}),(0,d.jsx)("b",{})]},t)}))})]})}})})(),(0,d.jsx)("div",{className:"tool-sep"}),(0,d.jsx)(w,{title:"Undo",action:"undo",disabled:!g,handleClick:n}),(0,d.jsx)(w,{title:"Redo",action:"redo",disabled:!y,handleClick:n}),(0,d.jsx)(w,{title:"Clear",action:"clear",disabled:!b,handleClick:n}),(0,d.jsx)(w,{title:"Delete Selected",action:"deleteSelected",disabled:!j,handleClick:n}),(0,d.jsx)("div",{className:"tool-sep"}),(0,d.jsx)("div",{className:"zoom-area",children:(0,d.jsx)(k,{children:function(e,t){return u()("zoom-tip",{active:e.isExpand}),(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(w,{title:"Zoom out",action:"zoom-out",handleClick:n}),(0,d.jsx)("span",{className:"zoom-level",children:T}),(0,d.jsx)(w,{title:"Zoom in",action:"zoom-in",handleClick:n})]})}})}),(0,d.jsx)("div",{className:"tool-action-btn primary-btn",id:"save-btn",onClick:x,children:"web"===e.props.type?"Save":"Done"}),"web"!==e.props.type&&!e.props.isReported&&("entire"===e.props.menuType||"selected"===e.props.menuType)&&(0,d.jsxs)("div",{className:"quick-issue",children:["Not properly captured?",(0,d.jsx)("a",{onClick:e.props.quickReport,children:" Report a problem."})]})]})})}}])&&D(t.prototype,n),r&&D(t,r),a}(o.PureComponent);var Y={slack:{displayName:"Slack",targetName:"Channel",placeHolder:"Choose a channel or user",panelTitle:"Send message",actionTypeStr:"Sending message",successMsg:"Slack message sent!",panelSubTitle:"Send screenshots to Slack",featureLists:["Send screenshots to Slack Channel","Send screenshots to Slack direct messages","Attach URL of the screenshot automatically"]},trello:{displayName:"Trello",targetName:"Board",placeHolder:"Choose a board",panelTitle:"Create card",actionTypeStr:"Creating card",successMsg:"Trello card created!",panelSubTitle:"Send screenshots as Trello cards",featureLists:["Create a trello card and attach the screenshot directly","Assign the card to members","Set due date and time","Include browser & OS info to help identify the issue"]},asana:{displayName:"Asana",targetName1:"Workspace",targetName2:"Project",placeHolder1:"Choose a workspace",placeHolder2:"Choose a project",panelTitle:"Create task",actionTypeStr:"Creating task",successMsg:"Asana task created!",panelSubTitle:"Send screenshots as Asana task",featureLists:["Send screenshots to Asana task","Create an Asana task and attach the screenshot directly","Assign the card to members","Choose Sections","Set due date and time","Include browser & OS info to help identify the issue"]},jira:{displayName:"Jira",targetName1:"Site",targetName2:"Project",placeHolder1:"Choose a site",placeHolder2:"Choose a project",panelTitle:"Create issue",actionTypeStr:"Creating issue",successMsg:"Jira issue created!",panelSubTitle:"Send screenshots as Jira issue",featureLists:["Create a Jira issue and attach the screenshot directly","Assign the card to members","Include browser & OS info to help identify the issue"]},googleDrive:{displayName:"Google Drive",targetName:"Folder",placeHolder:"Choose a folder",panelTitle:"Upload image",actionTypeStr:"Uploading image",successMsg:"Google Drive image uploaded!",panelSubTitle:"Save screenshots to Google Drive",featureLists:["Save screenshots to Google Drive folders directly"]},dropbox:{displayName:"Dropbox",targetName:"Folder",placeHolder:"Choose a folder",panelTitle:"Upload image",actionTypeStr:"Uploading image",successMsg:"Dropbox image uploaded!",panelSubTitle:"Save screenshots to Dropbox",featureLists:["Save screenshots to Dropbox folders directly"]},box:{displayName:"Box",targetName:"Folder",placeHolder:"Choose a folder",panelTitle:"Upload image",actionTypeStr:"Uploading image",successMsg:"Box image uploaded!",panelSubTitle:"Save screenshots to Box",featureLists:["Save screenshots to Box folders directly"]},github:{displayName:"Github",targetName:"Repository",placeHolder:"Choose a repository",panelTitle:"Create issue",actionTypeStr:"Creating issue",successMsg:"Github issue created!",panelSubTitle:"Send screenshots as Github issue",featureLists:["Send screenshots to Slack Channel","Send screenshots to Slack direct messages","Attach URL of the screenshot automatically"]}},W={channel:"#",repo:"",user:"@",board:"",project:"",folder:""},H=[{name:"slack",displayName:"Slack"},{name:"asana",displayName:"Asana"},{name:"trello",displayName:"Trello"},{name:"github",displayName:"Github"},{name:"jira",displayName:"Jira"}],q=[{name:"googleDrive",displayName:"Google Drive"},{name:"dropbox",displayName:"Dropbox"},{name:"box",displayName:"Box"}],G=["callout","list"],V=n(42286),$=n(16931);function J(e){return(J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function K(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function X(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?K(Object(n),!0).forEach((function(t){Q(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):K(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Q(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ee(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function te(e,t){return(te=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ne(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ae(e);if(t){var i=ae(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return re(this,n)}}function re(e,t){return!t||"object"!==J(t)&&"function"!=typeof t?ie(e):t}function ie(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ae(e){return(ae=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}const oe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&te(e,t)}(a,e);var t,n,r,i=ne(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,e)).outerContainer=(0,o.createRef)(),t.container=(0,o.createRef)(),t.doodleCanvas=(0,o.createRef)(),t.layerCanvas=(0,o.createRef)(),t.textareaOut=(0,o.createRef)(),t.textarea=(0,o.createRef)(),t.listDialog=(0,o.createRef)(),t.fileInput=(0,o.createRef)(),t.state={isInCropMode:!1,currentTool:"curve",currentColor:localStorage["pen-color"]||"rgb(255, 0, 0)",currentPenWidth:localStorage["pen-width"]?parseInt(localStorage["pen-width"]):window.devicePixelRatio>1?8:4,currentFontSize:localStorage["font-size"]?parseInt(localStorage["font-size"]):window.devicePixelRatio>1?36:24,currentFontFamily:localStorage["font-family"]||"Times New Roman",cropWidth:0,cropHeight:0,resizeWidth:0,resizeHeight:0,resizeProportional:!0,currentScale:1,canUndo:!1,canRedo:!1,canClear:!1,canDeleteSelected:!1,isShownUpgrade:!1,isReady:!1,upgradeType:"",isTextBackground:!1},t.handleToolBarBtnClick=t.handleToolBarBtnClick.bind(ie(t)),t.handleFileInputChange=t.handleFileInputChange.bind(ie(t)),t.editor_style_callback=t.editor_style_callback.bind(ie(t)),t.initEditor=t.initEditor.bind(ie(t)),t.insertImage=t.insertImage.bind(ie(t)),t.handleResizeInputChange=t.handleResizeInputChange.bind(ie(t)),t.handleResizeProportionChange=t.handleResizeProportionChange.bind(ie(t)),t.getResizeInfo=t.getResizeInfo.bind(ie(t)),t.finishEdit=t.finishEdit.bind(ie(t)),t.handleKeyDown=t.handleKeyDown.bind(ie(t)),t.handleCloseUpgrade=t.handleCloseUpgrade.bind(ie(t)),t.handleTextBgChange=t.handleTextBgChange.bind(ie(t)),t.handleResetList=t.handleResetList.bind(ie(t)),t}return t=a,(n=[{key:"componentDidMount",value:function(){this.initEditor(this.props.imageUrl),document.querySelector("#canvas2")&&document.querySelector("#canvas2").addEventListener("click",(function(){document.querySelectorAll(".tool-select").forEach((function(e){e.blur()}))}),!1),document.addEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(e){e.imageUrl===this.props.imageUrl||""!==e.imageUrl&&void 0!==e.imageUrl||this.initEditor(this.props.imageUrl)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown),this.editor=null}},{key:"handleKeyDown",value:function(e){var t=e.keyCode;if(-1!==this.props.className.indexOf("active"))if(90===t&&(e.ctrlKey||e.metaKey))e.shiftKey?this.editor.redo():this.editor.undo();else if((46===t||8===t)&&this.state.canDeleteSelected){if(e.target.classList.contains("editor-textarea"))return;this.editor.deleteSelected()}}},{key:"finishEdit",value:function(e,t){var n=this;this.editor.getImageDataBlob(this.props.contentType,(function(e){var r=window.URL.createObjectURL(e);if(t)n.props.handleFinishEditAndShare(r,e);else{var i=n.editor.bg_info;n.props.handleFinishEdit(r,e,{width:i.width,height:i.height})}}))}},{key:"handleResetList",value:function(){this.editor.resetList()}},{key:"handleTextBgChange",value:function(){this.editor.setTextBackground(!this.state.isTextBackground),this.setState({isTextBackground:!this.state.isTextBackground})}},{key:"handleResizeProportionChange",value:function(e){this.setState({resizeProportional:e.target.checked})}},{key:"handleResizeInputChange",value:function(e,t){var n=this.editor.bg_info.width/this.editor.bg_info.height;"width"===e?!0===this.state.resizeProportional?this.setState({resizeWidth:parseInt(t.target.value),resizeHeight:parseInt(t.target.value)/n}):this.setState({resizeWidth:parseInt(t.target.value)}):!0===this.state.resizeProportional?this.setState({resizeWidth:parseInt(t.target.value)*n,resizeHeight:parseInt(t.target.value)}):this.setState({resizeHeight:parseInt(t.target.value)})}},{key:"getResizeInfo",value:function(){var e=this.editor.bg_info;this.setState({resizeHeight:parseInt(e.height),resizeWidth:parseInt(e.width)})}},{key:"handleFileInputChange",value:function(e){var t=e.target.files[0],n=URL.createObjectURL(t);this.insertImage(n)}},{key:"editor_style_callback",value:function(e,t){switch(e){case"crop":"done"!==t&&this.setState({cropWidth:t.width,cropHeight:t.height});break;case"undo":this.setState({canUndo:t});break;case"redo":this.setState({canRedo:t});break;case"del":this.setState({canDeleteSelected:t});break;case"clear":this.setState({canClear:!t})}}},{key:"initEditor",value:function(e){if(e){var t=this,n=new Image;n.crossOrigin="Anonymous",this.editor=new $.Z({out_container:this.outerContainer.current,container:this.container.current,doodle_canvas:this.doodleCanvas.current,layer_canvas:this.layerCanvas.current,textarea:this.textarea.current,textarea_out:this.textareaOut.current,$list_dialog:this.listDialog.current,image:n},(function(e,n){t.editor_style_callback(e,n)})),n.src=e,n.onload=function(){t.editor.setBgImage(n,!1),t.editor.setPenColor(t.state.currentColor),t.editor.setPenType("curve"),t.editor.setFontSize(t.state.currentFontSize),t.editor.setPenWidth(t.state.currentPenWidth),t.editor.setFontName(t.state.currentFontFamily),t.editor.setBlurRadius(30),t.setState({isReady:!0})}}}},{key:"insertImage",value:function(e){var t=this,n=new Image;n.src=e;var r={image:n,width:0,height:0,choose_type:"full"};n.img_info=r,n.onload=function(){r.width=this.naturalWidth,r.height=this.naturalHeight,t.editor.insertSvgImage(r)}}},{key:"handleCloseUpgrade",value:function(){this.setState({isShownUpgrade:!1})}},{key:"handleToolBarBtnClick",value:function(e,t){var n=this.editor;if("shape"===e){if(-1!==G.indexOf(t)&&!this.props.permissions.allowAdvancedToolForImageEditor)return void this.setState({upgradeType:t,isShownUpgrade:!0});"highlight"==t?(n.unSelectAll(),n.setPenOpacity(.3),n.setPenWidth(16),n.setPenType("highlight")):(n.setPenOpacity(1),n.setPenWidth(this.state.currentPenWidth),n.setPenType(t)),this.setState({currentTool:t})}else if("action"===e)switch(t.actionType){case"crop":this.setState({isInCropMode:!0}),n.cutImage();break;case"changeColor":this.setState({currentColor:t.value}),n.setPenColor(t.value),localStorage["pen-color"]=t.value;break;case"changePenWidth":this.setState({currentPenWidth:t.value}),n.setPenWidth(parseInt(t.value)),localStorage["pen-width"]=t.value;break;case"changeFontSize":this.setState({currentFontSize:t.value}),n.setFontSize(parseInt(t.value)),localStorage["font-size"]=t.value;break;case"changeFontFamily":this.setState({currentFontFamily:t.value}),n.setFontName(t.value),localStorage["font-family"]=t.value;break;case"zoom-in":if(2!==this.state.currentScale){var r=this.state.currentScale+.25;n.setScale(r),this.setState({currentScale:r,isShowScaleTip:!0})}break;case"zoom-out":.25!==this.state.currentScale&&(r=this.state.currentScale-.25,n.setScale(r),this.setState({currentScale:r,isShowScaleTip:!0}));break;case"resetScale":n.setScale(1),this.setState({currentScale:1,isShowScaleTip:!1});break;case"crop-demension-width":this.setState({cropWidth:parseInt(t.value)},(function(){n.setCropSize(this.state.cropWidth,this.state.cropHeight)}));break;case"crop-demension-height":this.setState({cropHeight:parseInt(t.value)},(function(){n.setCropSize(this.state.cropWidth,this.state.cropHeight)}));break;case"leaveCrop":this.setState({isInCropMode:!1,cropWidth:0,cropHeight:0}),n.finishCutImage(!1);break;case"doCrop":n.finishCutImage(!0),this.setState({isInCropMode:!1,cropWidth:0,cropHeight:0});break;case"insert-image":if(!this.props.permissions.allowAdvancedToolForImageEditor)return void this.setState({upgradeType:"insertImage",isShownUpgrade:!0});this.fileInput.current.click();break;case"doInsertImage":if(!this.props.permissions.allowAdvancedToolForImageEditor)return void this.setState({upgradeType:"image",isShownUpgrade:!0});if("web"===this.props.type)var i="/images/svg/"+t.value+".svg";else i="./images/svg/"+t.value+".svg";this.insertImage(i);break;case"doResize":n.setImageSize(this.state.resizeWidth,this.state.resizeHeight);break;default:n[t.actionType]()}}},{key:"render",value:function(){var e=this.state,t=e.isShownUpgrade,n=e.isReady,r=u()("editor",this.props.className),i=u()("loading-page",{active:!n});return(0,d.jsxs)("div",{className:r,tabIndex:"0",children:[(0,d.jsx)("div",{className:i,children:(0,d.jsxs)("div",{className:"center",children:[(0,d.jsx)("div",{className:"loading-spinner",children:(0,d.jsxs)("div",{className:"spinner",children:[(0,d.jsx)("div",{className:"rect1"}),(0,d.jsx)("div",{className:"rect2"}),(0,d.jsx)("div",{className:"rect3"}),(0,d.jsx)("div",{className:"rect4"}),(0,d.jsx)("div",{className:"rect5"})]})}),(0,d.jsxs)("div",{className:"brand",children:[(0,d.jsx)("div",{className:"logo"}),"AWESOME SCREENSHOT"]})]})}),(0,d.jsx)("input",{type:"file",className:"file-input",ref:this.fileInput,accept:".jpg,.jpeg,.png",onChange:this.handleFileInputChange}),(0,d.jsx)(B,X(X({},this.state),{},{handleToolBarBtnClick:this.handleToolBarBtnClick,handleResizeInputChange:this.handleResizeInputChange,handleResizeProportionChange:this.handleResizeProportionChange,handleResetList:this.handleResetList,getResizeInfo:this.getResizeInfo,finishEdit:this.finishEdit,handleTextBgChange:this.handleTextBgChange,handleBack:this.props.handleBack,type:this.props.type,quickReport:this.props.quickReport,isReported:this.props.isReported,menuType:this.props.menuType,allowAdvancedTool:this.props.permissions.allowAdvancedToolForImageEditor})),(0,d.jsx)("div",{className:"editor-outer-container",tabIndex:"0",id:"editor-outer-container",ref:this.outerContainer,children:(0,d.jsxs)("div",{className:"editor-container",ref:this.container,children:[(0,d.jsx)("canvas",{className:"doodle-canvas",id:"canvas",ref:this.doodleCanvas}),(0,d.jsx)("canvas",{className:"layer-canvas",id:"canvas2",ref:this.layerCanvas}),(0,d.jsx)("div",{className:"editor-outer-textarea",ref:this.textareaOut,children:(0,d.jsx)("textarea",{className:"editor-textarea",ref:this.textarea})}),(0,d.jsxs)("div",{className:"editor-list-dialog",ref:this.listDialog,children:["Number:",(0,d.jsx)("input",{type:"number"})]})]})}),(0,d.jsx)(V.Z,{visible:t,onCancel:this.handleCloseUpgrade,type:this.state.upgradeType})]})}}])&&ee(t.prototype,n),r&&ee(t,r),a}(o.PureComponent);n(96148);var se=n(69713),le=(n(96600),n(42696)),ce=(n(51105),n(16756)),ue=(n(27738),n(71577)),de=n(91816),he=n(63258),pe=n(88485),fe=n(55035),me=n(24616),ve=n(64302),ge=n(89366),ye=n(51816),be=n(57254),je=n(99165),xe=n(9669),we=n.n(xe),Se=n(27484),Ce=n.n(Se);function ke(e,t,n){function r(e){return e.charCodeAt(0)}t=t||"",n=n||1024;for(var i=atob(e),a=[],o=0;o<i.length;o+=n){var s=i.slice(o,o+n),l=Array.prototype.map.call(s,r),c=new Uint8Array(l);a.push(c)}return new Blob(a,{type:t})}function Ne(e){window.open(e)}function Oe(e){return"[object Array]"===Object.prototype.toString.call(e)}function De(e,t,n,r){var i={version:1,type:"doc",content:[]};if(e&&e.length&&i.content.push({type:"paragraph",content:[{type:"text",text:e}]}),i.content.push({type:"rule"}),t)for(var a in t){var o={type:"paragraph",content:[{type:"text",text:a+":",marks:[{type:"strong"}]},{type:"text",text:" "+t[a]}]};i.content.push(o)}return n&&(i.content.push({type:"paragraph",content:[{type:"text",text:"video"===r?"Click the link below to watch the video:":"Click the link below to see the image:"}]}),i.content.push({type:"paragraph",content:[{type:"text",text:n,marks:[{type:"link",attrs:{href:n,title:n}}]}]})),i}function Ie(e){return e?e.charAt(0).toUpperCase()+e.slice(1):""}function Te(e){var t=document.createElement("textarea");t.value=e,t.style.position="absolute",t.style.top="-999999px",document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t)}function Pe(e,t,n){var r=[],i=document.createElement("img");i.onload=function(){for(var e=this.height,a=this.width,o=Math.ceil(e/t),s=e%t,l=0;l<o;l++){var c,u,d=document.createElement("canvas"),h=d.getContext("2d");d.width=a,c=u=d.height=l!==o-1?t:s,h.drawImage(i,0,t*l,a,c,0,0,a,u),r.push(d.toDataURL())}n(r)},i.src=e}function Ae(e){function t(e){return new Promise((function(t,n){var r=new Image;r.crossOrigin="Anonymous",r.onload=function(){t({ele:r,height:r.height,width:r.width})},r.onerror=r.onabort=function(){n(e)},r.src=e}))}for(var n=[],r=0;r<e.length;r++)n.push(t(e[r]));return Promise.all(n)}function Ze(e){return new Promise((function(e,t){chrome.permissions.request({permissions:["downloads"]},(function(t){t&&e()}))}))}function Ue(e){var t=e.filename;"true"===localStorage["save-as"]&&localStorage.download_directory&&(e.filename=localStorage.download_directory+"/"+e.filename),chrome.downloads.download(e,(function(n){(void 0===n||chrome.runtime.lastError)&&Ee(e.url,t)}))}function Ee(e,t){var n=document.createElement("a"),r=document.createEvent("MouseEvents");r.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),n.setAttribute("href",e),n.setAttribute("download",t),n.rel="noopener",n.dispatchEvent(r)}function Re(e){if(!e)return"local-image-"+Ce()().format("YYYY-MM-DD_h_mm");var t=new URL(e),n=t.pathname?t.pathname.split("/").splice(1).join("-")+"-":"";return"AwesomeScreenshot-"+t.hostname.replace(/^https?:\/\/(www\.)?/,"").replace(/^([^\/]+)\.com/,"$1").replace(/[^A-Za-z0-9]+/g,"-").replace(/-+/g,"-").replace(/^[_\-]+/,"").replace(/[_\-]+$/,"")+"-"+n+Ce()().format("YYYY-MM-DD_h_mm")}function _e(e,t,n){navigator.clipboard.write([new ClipboardItem(Object.defineProperty({},e.type,{value:e,enumerable:!0}))]).then(t,n)}function Fe(e,t,n,r){var i=document.createElement("canvas"),a=i.getContext("2d"),o=n.length?"Captured at: "+Ce()().format("YYYY/MM/DD hh:mm")+"  URL: "+n:"Captured at: "+Ce()().format("YYYY/MM/DD hh:mm"),s="single",l=40,c="bold 24px Arial",u="bold 24px Arial";a.font=c;Me(a,o,t.width);var d=a.measureText("Captured at: ").width,h=a.measureText("URL: ").width;if(a.font=u,d+h+a.measureText(n).width+a.measureText(Ce()().format("YYYY/MM/DD hh:mm")+" ").width>t.width){s="multiple";var p=Me(a,"URL: "+n,t.width),f=p.length;l=40*(f+1)}i.width=t.width,i.height=t.height+l;var m=URL.createObjectURL(e),v=document.createElement("img");if(v.onload=function(){a.drawImage(v,0,l),i.toBlob((function(e){r(e)}))},v.src=m,a.fillStyle="#000000",a.fillRect(0,0,i.width,l),a.restore(),a.fillStyle="#ffffff",a.textBaseline="top",a.strokeStyle="#ffffff",a.font="bold 24px Arial","single"===s){a.fillText("Captured at: ",10,10),a.font=u,a.fillText(Ce()().format("YYYY/MM/DD hh:mm A")+" ",10+d,10);var g=a.measureText(Ce()().format("YYYY/MM/DD hh:mm A")+" ").width+20;n.length&&(a.font=c,a.fillText("URL: ",10+d+g,10),a.font=u,a.fillText(n,10+d+g+h,10))}else{a.fillText("Captured at: ",10,10),a.font=u,a.fillText(Ce()().format("MM/DD/YYYY, hh:mm A"),10+d,10);for(var y=0;y<p.length;y++)0===y?(a.font=c,a.fillText("URL: ",10,50),a.font=u,a.fillText(p[0].substring(5),10+h,50)):(a.font=u,a.fillText(p[y],10,10+40*(y+1)))}a.beginPath(),a.moveTo(0,l),a.stroke(),a.closePath()}function Me(e,t,n){n-=10;for(var r=t.split(""),i=[],a=r[0],o=1;o<r.length;o++){var s=r[o];e.measureText(a+" "+s).width<n?a+=s:(i.push(a),a=s)}return i.push(a),i}var Le="https://www.awesomescreenshot.com",Be="https://www.awesomescreenshot.com/api/v1",ze=["/premium/stripe/create_plan","/premium/stripe/change_plan","/folder/create","/folder/add_items","/folder/change_name","/trash/throw_into","/image/change_title","/video/update_title","/trash/restore","/trash/delete","/image/upload"],Ye=we().create({baseURL:Be});function We(){return(e=Le,t=["screenshot_personal_fullname","screenshot_personal_type","screenshot_personal_mail","screenshot_peronal_premium_level"],new Promise((function(n,r){chrome.cookies.getAll({url:e},(function(e){if("string"==typeof t){var r=e.filter((function(e){return e.name===t}));n(r)}else if(Array.isArray(t)){var i=e.filter((function(e){return-1!==t.indexOf(e.name)}));n(i)}}))}))).then((function(e){if(e.length){var t={};return e.forEach((function(e){t[e.name]=e})),{username:decodeURI(t.screenshot_personal_fullname.value),type:t.screenshot_personal_type.value,mail:t.screenshot_personal_mail.value,premiumLevel:t.screenshot_personal_premium_level?t.screenshot_personal_premium_level.value:""}}return null}));var e,t}function He(e){return Ye({method:"GET",url:"/account/auth",params:{service:e,from:"extension"}})}function qe(e){return Ye({method:"GET",url:"/account/load/resource",params:e})}function Ge(e,t,n,r,i,a){return Ye({method:"POST",url:"/destination/add",data:{accountID:e,resourceID:n,privacy:i,resourceName:r,resourceType:t,info:a}})}function Ve(e){return Ye({method:"GET",url:"/destination/image/upload_to_cloud_done",params:{Service:e}})}Ye.interceptors.request.use((function(e){return e}),(function(e){return a.ZP.error("Network error, Request timeout!"),Promise.reject()})),Ye.interceptors.response.use((function(e){if(e&&e.data&&1===e.data.code)return Promise.resolve(e.data.data);if(e.data.code,e.data.msg){if(-1!==ze.indexOf(e.config.url))return Promise.reject(e.data.msg);if(a.ZP.error(e.data.msg),"/pricing"!==window.location.pathname)return Promise.reject(e.data.msg)}}),(function(e){var t=e.response.status;return a.ZP.error("Network error! Error Code "+t),Promise.reject(e)}));n(10887);var $e=n(99930),Je=(n(37763),n(27049)),Ke=(n(74808),n(55852)),Xe=(n(17269),n(25779)),Qe=(n(5786),n(32074)),et=(n(82766),n(16317)),tt=n(49101),nt=n(59879);function rt(e){return(rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function it(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function at(e,t){return(at=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ot(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ct(e);if(t){var i=ct(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return st(this,n)}}function st(e,t){return!t||"object"!==rt(t)&&"function"!=typeof t?lt(e):t}function lt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ct(e){return(ct=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}et.Z.Option;const ut=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&at(e,t)}(o,e);var t,n,r,i=ot(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=i.call(this,e)).state={isUploading:!1,isShownUpgrade:!1,percentage:0,isInCreate:!1,isCreateLoading:!1,premiumAlertType:"",isFolderCreated:!1,selectedFolder:"0-.-My Items"},t.handleUpload=t.handleUpload.bind(lt(t)),t.handleCreateProject=t.handleCreateProject.bind(lt(t)),t.enterCreate=t.enterCreate.bind(lt(t)),t.leaveCreate=t.leaveCreate.bind(lt(t)),t.onUploadProgress=t.onUploadProgress.bind(lt(t)),t.getCando=t.getCando.bind(lt(t)),t.handleCancelUpgrade=t.handleCancelUpgrade.bind(lt(t)),t.handleSelectFolder=t.handleSelectFolder.bind(lt(t)),t}return t=o,(n=[{key:"componentDidMount",value:function(){}},{key:"handleUpload",value:function(e){var t=this;try{(new ColorThief).getColor(this.props.img).join(",")}catch(e){}var n=this.state.selectedFolder.split("-.-")[0],r=this.state.selectedFolder.split("-.-")[1];this.setState({isUploading:!0});var i="image/png"===this.props.contentType?".png":".jpg";new File([this.props.imageBlob],e.name+i,{type:this.props.contentType}),function(e,t,n,r,i){var a=new FormData;return a.append("file",t),a.append("title",n),a.append("folderID",e),a.append("share",!0),a.append("actionType","ext"),a.append("version",r),a.append("client",/Edg/.test(navigator.userAgent)?"Edge extension":"chrome extension"),Ye({method:"POST",url:"/image/upload",data:a,onUploadProgress:function(e){var t=Math.round(100*e.loaded/e.total);i(t)}})}(n,this.props.imageBlob,e.name,chrome.extension.getBackgroundPage().currentversion,this.onUploadProgress).then((function(e){var i;(i=e.image.shareURI,we()({method:"GET",url:"https://tinyurl.com/api-create.php?url="+i})).then((function(e){t.props.onUploadFinish({projectName:r,projectId:n,url:e.data})})).catch((function(){t.props.onUploadFinish({projectName:r,projectId:n,url:e.image.shareURI})}))})).catch((function(e){"Premium Plan Required!"===e&&t.setState({isShownUpgrade:!0,isUploading:!1,percentage:0,premiumAlertType:"uploadImage"})}))}},{key:"handleCreateProject",value:function(e){var t=this;this.setState({isCreateLoading:!0}),function(e,t){return Ye({method:"POST",url:"/folder/create",data:{name:e,parentID:t}})}(e.pName,"0").then((function(e){t.setState({isCreateLoading:!1,isInCreate:!1,selectedFolder:e.folder.folderID+"-.-"+e.folder.name}),t.props.onFolderCreated(e.folder)})).catch((function(e){a.ZP.error(e),t.setState({isCreateLoading:!1})}))}},{key:"getCando",value:function(e,t){return"project"===e?"free"!==this.props.currentPlan.PlanName||this.props.projects.length<1:"image"===e?"free"!==this.props.currentPlan.PlanName||this.props.projectsHash[t].ImgCount<30:void 0}},{key:"handleCancelUpgrade",value:function(){this.setState({isShownUpgrade:!1})}},{key:"enterCreate",value:function(){this.setState({isInCreate:!0})}},{key:"leaveCreate",value:function(){this.setState({isInCreate:!1})}},{key:"onUploadProgress",value:function(e){this.setState({percentage:e})}},{key:"handleSelectFolder",value:function(e){this.setState({selectedFolder:e})}},{key:"render",value:function(){var e=this,t=this.state,n=t.isUploading,r=t.percentage,i=t.isInCreate,a=t.isCreateLoading,o=t.premiumAlertType,s=t.isShownUpgrade,l=this.props,c=l.tabTitle,u=l.foldersTreeData;return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{className:"save-to-aws-panel",children:[(0,d.jsxs)("div",{className:"title",children:[(0,d.jsx)("div",{className:"logo",children:(0,d.jsx)("b",{})}),i?"Create a New Folder":"Awesome Screenshot"]}),(0,d.jsx)("div",{className:"box",children:n?(0,d.jsxs)("div",{className:"upload-progress",children:[(0,d.jsx)(Qe.Z,{type:"circle",percent:r}),(0,d.jsx)("div",{className:"upload-tip",children:r<100?"Uploading...":"Creating shareable link..."})]}):i?(0,d.jsxs)(Ke.Z,{name:"createProject",onFinish:e.handleCreateProject,children:[(0,d.jsx)("div",{className:"label",children:"Folder name"}),(0,d.jsx)(Ke.Z.Item,{name:"pName",rules:[{required:!0,message:"Please input a folder name!"}],children:(0,d.jsx)(Xe.Z,{size:"large"})}),(0,d.jsxs)(Ke.Z.Item,{style:{textAlign:"right"},children:[(0,d.jsx)(ue.Z,{size:"large",onClick:e.leaveCreate,style:{marginRight:8},children:"Cancel"}),(0,d.jsx)(ue.Z,{size:"large",type:"primary",htmlType:"submit",loading:a,children:"Create"})]})]}):(0,d.jsxs)(Ke.Z,{name:"uploadAwsForm",onFinish:e.handleUpload,children:[(0,d.jsx)("div",{className:"label",children:"Name"}),(0,d.jsx)(Ke.Z.Item,{name:"name",rules:[{required:!0,message:"Please input a name!"}],initialValue:c,children:(0,d.jsx)(Xe.Z,{size:"large"})}),(0,d.jsx)("div",{className:"label",children:"Folder"}),(0,d.jsx)($e.Z,{style:{width:"100%",marginBottom:"20px"},showSearch:!0,treeData:u,treeIcon:!0,loading:e.props.isfolderLoading,value:e.props.isfolderLoading?"":e.state.selectedFolder,onChange:e.handleSelectFolder,filterTreeNode:function(e,t){return-1!==t.title.indexOf(e)},dropdownRender:function(t){return(0,d.jsxs)("div",{children:[t,(0,d.jsx)(Je.Z,{}),(0,d.jsxs)("div",{className:"select-action-btn",onClick:e.enterCreate,children:[(0,d.jsx)(tt.Z,{}),"Create a New Folder"]}),(0,d.jsxs)("div",{className:"select-action-btn",onClick:e.props.onRefreshProjects,children:[(0,d.jsx)(nt.Z,{}),"Refresh Folders"]})]})}}),(0,d.jsx)(Ke.Z.Item,{children:(0,d.jsx)(ue.Z,{size:"large",type:"primary",className:"save-btn",block:!0,htmlType:"submit",children:"Upload"})})]})})]}),(0,d.jsx)(V.Z,{visible:s,onCancel:this.handleCancelUpgrade,type:o})]})}}])&&it(t.prototype,n),r&&it(t,r),o}(o.Component);function dt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ht(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?dt(Object(n),!0).forEach((function(t){pt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):dt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function pt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const ft=function(e){return(0,d.jsx)(r.Z,ht(ht({},e),{},{footer:null,maskClosable:!1,wrapClassName:"save-to-aws",destroyOnClose:!0,centered:!0,children:(0,d.jsx)(ut,ht({},e))}))};var mt=n(1168);function vt(e){return new Promise((function(t,n){var r=null;Ae(e).then((function(n){n.forEach((function(n,i){var a=n.width,o=n.height;r?r.addPage([Math.ceil(a),Math.ceil(o)],a>o?"l":"p"):r=new mt.ZP({orientation:a>o?"l":"p",unit:"pt",format:[Math.ceil(a),Math.ceil(o)],compress:!0});var s=document.createElement("canvas"),l=s.getContext("2d");s.width=a,s.height=o,l.drawImage(n.ele,0,0,a,o,0,0,a,o);var c=s.toDataURL("image/jpeg",1);r.addImage(c,"JPEG",0,0,Math.ceil(a),Math.ceil(o),"","FAST"),i===e.length-1&&t(r.output("bloburl"))}))}))}))}function gt(e,t){return new Promise((function(t,n){var r=14400;Ae(e).then((function(e){var n=new mt.ZP({orientation:e[0].width>e[0].height?"l":"p",unit:"pt",format:[Math.ceil(e[0].width),Math.ceil(r)],compress:!0}),i=r;e.forEach((function(e,t){for(var a=e.width,o=0,s=e.height;o<e.height;)if(i>0){var l=Math.min(s,i),c=document.createElement("canvas"),u=c.getContext("2d");c.width=a,c.height=l,u.drawImage(e.ele,0,o,a,l,0,0,a,l);var d=c.toDataURL("image/jpeg",1);n.addImage(d,"JPEG",0,r-i,Math.ceil(a),Math.ceil(l),"","FAST"),o+=l,s-=i,i-=l}else n.addPage({format:[a,r]}),i=r})),t(n.output("bloburl"))}))}))}var yt=n(1646),bt=n.n(yt),jt=(n(25833),n(47933));function xt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return wt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return wt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function wt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var St=et.Z.Option,Ct=et.Z.OptGroup,kt=jt.ZP.Group,Nt={};const Ot=function(e){var t=e.currentAccount,n=xt((0,o.useState)([]),2),r=n[0],i=n[1],a=xt((0,o.useState)([]),2),s=a[0],l=a[1];(0,o.useEffect)((function(){Promise.all([qe({accountID:t.id,what:"channel"}),qe({accountID:t.id,what:"member"})]).then((function(e){var t=e[0].items.concat(e[1].items);i(t.filter((function(e){return e.added}))),l(t.filter((function(e){return!e.added}))),Nt={},t.forEach((function(e){Nt[e.id]=e}))}))}),[]);var c=Y.slack;return(0,d.jsxs)(Ke.Z,{onFinish:function(n){Ge(t.id,Nt[n.channel].type,n.channel,Nt[n.channel].name,n.privacy,Nt[n.channel].info).then((function(t){e.handleDesCreated(t.destination)}))},children:[(0,d.jsx)("div",{className:"label",children:c.targetName}),(0,d.jsx)(Ke.Z.Item,{name:"channel",rules:[{required:!0,message:"Please choose a channel or member"}],children:(0,d.jsxs)(et.Z,{showSearch:!0,placeholder:c.placeHolder,loading:r.length+s.length===0,filterOption:function(e,t){if(t.name)return t.name.toLowerCase().indexOf(e.toLowerCase())>=0},children:[r.length&&(0,d.jsx)(Ct,{label:"Already Added",children:r.map((function(e){return(0,d.jsx)(St,{value:e.id,name:e.name,disabled:!0,children:W[e.type]+e.name},e.id)}))}),(0,d.jsx)(Ct,{label:"Available",children:s.map((function(e){return(0,d.jsx)(St,{value:e.id,name:e.name,children:W[e.type]+e.name},e.id)}))})]})}),(0,d.jsx)(Ke.Z.Item,{className:"des-share-option",name:"privacy",initialValue:"private",children:(0,d.jsxs)(kt,{children:[(0,d.jsx)(jt.ZP,{value:"private",children:"Private"}),(0,d.jsx)(jt.ZP,{value:"shared",children:"Shared"})]})}),(0,d.jsx)(ue.Z,{type:"primary",className:"add-des-btn",size:"large",block:!0,htmlType:"submit",children:"Create Destination"})]})};function Dt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return It(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return It(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function It(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Tt=et.Z.Option,Pt=et.Z.OptGroup,At=jt.ZP.Group,Zt={};const Ut=function(e){var t=e.currentAccount,n=Dt((0,o.useState)([]),2),r=n[0],i=n[1],a=Dt((0,o.useState)([]),2),s=a[0],l=a[1];(0,o.useEffect)((function(){qe({accountID:t.id,what:"board"}).then((function(e){var t=e.items;i(t.filter((function(e){return e.added}))),l(t.filter((function(e){return!e.added}))),Zt={},t.forEach((function(e){Zt[e.id]=e}))}))}),[]);var c=Y.trello;return(0,d.jsxs)(Ke.Z,{onFinish:function(n){Ge(t.id,Zt[n.channel].type,n.channel,Zt[n.channel].name,n.privacy,Zt[n.channel].info).then((function(t){e.handleDesCreated(t.destination)}))},children:[(0,d.jsx)("div",{className:"label",children:c.targetName}),(0,d.jsx)(Ke.Z.Item,{name:"channel",rules:[{required:!0,message:"Please choose a board"}],children:(0,d.jsxs)(et.Z,{showSearch:!0,placeholder:c.placeHolder,loading:r.length+s.length===0,filterOption:function(e,t){if(t.name)return t.name.toLowerCase().indexOf(e.toLowerCase())>=0},children:[r.length&&(0,d.jsx)(Pt,{label:"Already Added",children:r.map((function(e){return(0,d.jsx)(Tt,{value:e.id,name:e.name,disabled:!0,children:W[e.type]+e.name},e.id)}))}),(0,d.jsx)(Pt,{label:"Available",children:s.map((function(e){return(0,d.jsx)(Tt,{value:e.id,name:e.name,children:W[e.type]+e.name},e.id)}))})]})}),(0,d.jsx)(Ke.Z.Item,{className:"des-share-option",name:"privacy",initialValue:"private",children:(0,d.jsxs)(At,{children:[(0,d.jsx)(jt.ZP,{value:"private",children:"Private"}),(0,d.jsx)(jt.ZP,{value:"shared",children:"Shared"})]})}),(0,d.jsx)(ue.Z,{type:"primary",className:"add-des-btn",size:"large",block:!0,htmlType:"submit",children:"Create Destination"})]})};function Et(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Rt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Rt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Rt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var _t=et.Z.Option,Ft=et.Z.OptGroup,Mt=jt.ZP.Group,Lt={},Bt={};const zt=function(e){var t=e.currentAccount,n=Et((0,o.useState)([]),2),r=n[0],i=n[1],a=Et((0,o.useState)([]),2),s=a[0],l=a[1],c=Et((0,o.useState)([]),2),u=c[0],h=c[1];(0,o.useEffect)((function(){qe({accountID:t.id,what:"workspace"}).then((function(e){var t=e.items;i(t),f(t[0].id),Bt={},t.forEach((function(e){Bt[e.id]=e}))}))}),[]);var p=Y.asana;function f(e){l([]),h([]),qe({accountID:t.id,what:"project",workspaceID:e}).then((function(e){var t=e.items;l(t.filter((function(e){return e.added}))),h(t.filter((function(e){return!e.added}))),Lt={},t.forEach((function(e){Lt[e.id]=e}))}))}return(0,d.jsxs)(Ke.Z,{onFinish:function(n){Ge(t.id,"project",n.project,Lt[n.project].name,n.privacy,Lt[n.project].info).then((function(t){e.handleDesCreated(t.destination)}))},children:[(0,d.jsx)("div",{className:"label",children:p.targetName1}),(0,d.jsx)(Ke.Z.Item,{name:"workspace",rules:[{required:!0,message:"Please choose a workspace"}],children:(0,d.jsx)(et.Z,{placeholder:p.placeHolder1,loading:0===r.length,onChange:function(e){f(e)},children:r.map((function(e){return(0,d.jsx)(_t,{value:e.id,children:e.name},e.id)}))})}),(0,d.jsx)("div",{className:"label",children:p.targetName2}),(0,d.jsx)(Ke.Z.Item,{name:"project",rules:[{required:!0,message:"Please choose a project"}],children:(0,d.jsxs)(et.Z,{showSearch:!0,placeholder:p.placeHolder2,loading:s.length+u.length===0,filterOption:function(e,t){if(t.name)return t.name.toLowerCase().indexOf(e.toLowerCase())>=0},children:[s.length&&(0,d.jsx)(Ft,{label:"Already Added",children:s.map((function(e){return(0,d.jsx)(_t,{value:e.id,name:e.name,disabled:!0,children:W[e.type]+e.name},e.id)}))}),(0,d.jsx)(Ft,{label:"Available",children:u.map((function(e){return(0,d.jsx)(_t,{value:e.id,name:e.name,children:W[e.type]+e.name},e.id)}))})]})}),(0,d.jsx)(Ke.Z.Item,{className:"des-share-option",name:"privacy",initialValue:"private",children:(0,d.jsxs)(Mt,{children:[(0,d.jsx)(jt.ZP,{value:"private",children:"Private"}),(0,d.jsx)(jt.ZP,{value:"shared",children:"Shared"})]})}),(0,d.jsx)(ue.Z,{type:"primary",className:"add-des-btn",size:"large",block:!0,htmlType:"submit",children:"Create Destination"})]})};function Yt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Wt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Wt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Wt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ht=et.Z.Option,qt=et.Z.OptGroup,Gt=jt.ZP.Group,Vt={};const $t=function(e){var t=e.currentAccount,n=Yt((0,o.useState)([]),2),r=n[0],i=n[1],a=Yt((0,o.useState)([]),2),s=a[0],l=a[1],c=function(e){qe({accountID:t.id,what:"folder",query:e}).then((function(e){var t=e.items;i(t.filter((function(e){return e.added}))),l(t.filter((function(e){return!e.added}))),Vt={},t.forEach((function(e){Vt[e.id]=e}))}))};(0,o.useEffect)((function(){c()}),[]);var u=Y.googleDrive;return(0,d.jsxs)(Ke.Z,{onFinish:function(n){Ge(t.id,Vt[n.folder].type,n.folder,Vt[n.folder].name,n.privacy,Vt[n.folder].info).then((function(t){e.handleDesCreated(t.destination)}))},children:[(0,d.jsx)("div",{className:"label",children:u.targetName}),(0,d.jsxs)(Ke.Z.Item,{name:"folder",rules:[{required:!0,message:"choose a folder"}],children:[(0,d.jsxs)(et.Z,{showSearch:!0,placeholder:u.placeHolder,loading:r.length+s.length===0,onSearch:function(e){c(e)},filterOption:!1,children:[r.length&&(0,d.jsx)(qt,{label:"Already Added",children:r.map((function(e){return(0,d.jsx)(Ht,{value:e.id,disabled:!0,children:W[e.type]+e.name},e.id)}))}),(0,d.jsx)(qt,{label:"Available",children:s.map((function(e){return(0,d.jsx)(Ht,{value:e.id,children:W[e.type]+e.name},e.id)}))})]}),(0,d.jsx)("div",{className:"tip",children:"Only 10 recent folders are listed. Type and search for other folders."})]}),(0,d.jsx)(Ke.Z.Item,{className:"des-share-option",name:"privacy",initialValue:"private",children:(0,d.jsxs)(Gt,{children:[(0,d.jsx)(jt.ZP,{value:"private",children:"Private"}),(0,d.jsx)(jt.ZP,{value:"shared",children:"Shared"})]})}),(0,d.jsx)(ue.Z,{type:"primary",className:"add-des-btn",size:"large",block:!0,htmlType:"submit",children:"Create Destination"})]})};function Jt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Kt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Kt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Kt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Xt=et.Z.Option,Qt=et.Z.OptGroup,en=jt.ZP.Group,tn={};const nn=function(e){var t=e.currentAccount,n=Jt((0,o.useState)([]),2),r=n[0],i=n[1],a=Jt((0,o.useState)([]),2),s=a[0],l=a[1];(0,o.useEffect)((function(){qe({accountID:t.id,what:"repo"}).then((function(e){var t=e.items;i(t.filter((function(e){return e.added}))),l(t.filter((function(e){return!e.added}))),tn={},t.forEach((function(e){tn[e.id]=e}))}))}),[]);var c=Y.github;return(0,d.jsxs)(Ke.Z,{onFinish:function(n){Ge(t.id,tn[n.repo].type,n.repo,tn[n.repo].name,n.privacy,tn[n.repo].info).then((function(t){e.handleDesCreated(t.destination)}))},children:[(0,d.jsx)("div",{className:"label",children:c.targetName}),(0,d.jsx)(Ke.Z.Item,{name:"repo",rules:[{required:!0,message:"Please choose a channel or member"}],children:(0,d.jsxs)(et.Z,{placeholder:c.placeHolder,loading:r.length+s.length===0,showSearch:!0,onSearch:function(e){},filterOption:function(e,t){if(t.name)return t.name.toLowerCase().indexOf(e.toLowerCase())>=0},children:[r.length&&(0,d.jsx)(Qt,{label:"Already Added",children:r.map((function(e){return(0,d.jsx)(Xt,{value:e.id,name:e.info.owner+e.name,disabled:!0,children:W[e.type]+e.info.owner+"/"+e.name},e.id)}))}),(0,d.jsx)(Qt,{label:"Available",children:s.map((function(e){return(0,d.jsx)(Xt,{value:e.id,name:e.info.owner+e.name,children:W[e.type]+e.info.owner+"/"+e.name},e.id)}))})]})}),(0,d.jsx)(Ke.Z.Item,{className:"des-share-option",name:"privacy",initialValue:"private",children:(0,d.jsxs)(en,{children:[(0,d.jsx)(jt.ZP,{value:"private",children:"Private"}),(0,d.jsx)(jt.ZP,{value:"shared",children:"Shared"})]})}),(0,d.jsx)(ue.Z,{type:"primary",className:"add-des-btn",size:"large",block:!0,htmlType:"submit",children:"Create Destination"})]})};function rn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return an(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return an(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function an(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var on=et.Z.Option,sn=et.Z.OptGroup,ln=jt.ZP.Group,cn={},un={};const dn=function(e){var t=e.currentAccount,n=rn((0,o.useState)([]),2),r=n[0],i=n[1],a=rn((0,o.useState)([]),2),s=a[0],l=a[1],c=rn((0,o.useState)([]),2),u=c[0],h=c[1];(0,o.useEffect)((function(){qe({accountID:t.id,what:"cloud"}).then((function(e){var t=e.items;i(t),f(t[0].id,t[0].name),un={},t.forEach((function(e){un[e.id]=e}))}))}),[]);var p=Y.jira;function f(e,n){l([]),h([]),qe({accountID:t.id,what:"project",cloudID:e,cloudName:n}).then((function(e){var t=e.items;l(t.filter((function(e){return e.added}))),h(t.filter((function(e){return!e.added}))),cn={},t.forEach((function(e){cn[e.id]=e}))}))}return(0,d.jsxs)(Ke.Z,{onFinish:function(n){Ge(t.id,"project",n.project,cn[n.project].name,n.privacy,cn[n.project].info).then((function(t){e.handleDesCreated(t.destination)}))},children:[(0,d.jsx)("div",{className:"label",children:p.targetName1}),(0,d.jsx)(Ke.Z.Item,{name:"site",rules:[{required:!0,message:"Please choose a site"}],children:(0,d.jsx)(et.Z,{placeholder:p.placeHolder1,loading:0===r.length,onChange:function(e){f(e,un[e].name)},children:r.map((function(e){return(0,d.jsx)(on,{value:e.id,children:e.name},e.id)}))})}),(0,d.jsx)("div",{className:"label",children:p.targetName2}),(0,d.jsx)(Ke.Z.Item,{name:"project",rules:[{required:!0,message:"Please choose a project"}],children:(0,d.jsxs)(et.Z,{showSearch:!0,placeholder:p.placeHolder2,loading:s.length+u.length===0,filterOption:function(e,t){if(t.name)return t.name.toLowerCase().indexOf(e.toLowerCase())>=0},children:[s.length&&(0,d.jsx)(sn,{label:"Already Added",children:s.map((function(e){return(0,d.jsx)(on,{value:e.id,name:e.name,disabled:!0,children:W[e.type]+e.name},e.id)}))}),(0,d.jsx)(sn,{label:"Available",children:u.map((function(e){return(0,d.jsx)(on,{value:e.id,name:e.name,children:W[e.type]+e.name},e.id)}))})]})}),(0,d.jsx)(Ke.Z.Item,{className:"des-share-option",name:"privacy",initialValue:"private",children:(0,d.jsxs)(ln,{children:[(0,d.jsx)(jt.ZP,{value:"private",children:"Private"}),(0,d.jsx)(jt.ZP,{value:"shared",children:"Shared"})]})}),(0,d.jsx)(ue.Z,{type:"primary",className:"add-des-btn",size:"large",block:!0,htmlType:"submit",children:"Create Destination"})]})};function hn(e){return(hn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function fn(e,t){return(fn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function mn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=yn(e);if(t){var i=yn(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return vn(this,n)}}function vn(e,t){return!t||"object"!==hn(t)&&"function"!=typeof t?gn(e):t}function gn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yn(e){return(yn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var bn={},jn=et.Z.Option;et.Z.OptGroup;Ce().extend(bt());const xn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fn(e,t)}(a,e);var t,n,r,i=mn(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,e)).state={isInAuthMode:!1,isLoadList:!1,currentResources:[],createAccount:"",createPrivacy:"private",createResource:null,isCreating:!1,currentAccount:e.currentAccount||(e.accounts?e.accounts[0]:null)||null,isShownUpgrade:!1},t.chooseDes=t.chooseDes.bind(gn(t)),t.back=t.back.bind(gn(t)),t.handleAccountChange=t.handleAccountChange.bind(gn(t)),t.handleConnect=t.handleConnect.bind(gn(t)),t.handlePrivacyChange=t.handlePrivacyChange.bind(gn(t)),t.handleResourceChange=t.handleResourceChange.bind(gn(t)),t.updateCurrentResources=t.updateCurrentResources.bind(gn(t)),t.handleMessage=t.handleMessage.bind(gn(t)),t.onAccountConnected=t.onAccountConnected.bind(gn(t)),t.handleUpgradeCancel=t.handleUpgradeCancel.bind(gn(t)),t.getPermissionByName=t.getPermissionByName.bind(gn(t)),t.getFreeTrialTip=t.getFreeTrialTip.bind(gn(t)),t.getIsShowPro=t.getIsShowPro.bind(gn(t)),t}return t=a,(n=[{key:"componentDidMount",value:function(){window.addEventListener("message",this.handleMessage)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("message",this.handleMessage)}},{key:"handleMessage",value:function(e){if("accountConnected"===e.data.name){var t=JSON.parse(e.data.data);this.setState({isInAuthMode:!1}),this.onAccountConnected(t)}}},{key:"handleUpgradeCancel",value:function(){this.setState({isShownUpgrade:!1})}},{key:"onAccountConnected",value:function(e){this.props.handleAccountConnected(e),this.setState({currentAccount:e})}},{key:"chooseDes",value:function(e){this.getPermissionByName(e)?this.setState({isInAuthMode:!0,createAccount:e}):this.setState({isShownUpgrade:!0})}},{key:"getPermissionByName",value:function(e){return"googleDrive"===e?this.props.permissions["allow".concat(Ie(e))]:this.props.permissions["allow".concat(Ie(e))]||"free"!==this.props.currentPlan.PlanName}},{key:"getFreeTrialTip",value:function(){var e=this.props.permissions;if(e.trailConnectedAccountExpireTimeSecond>0){if(e.trailConnectedAccountExpireTimeSecond>Date.now()/1e3){var t=1e3*e.trailConnectedAccountExpireTimeSecond-Date.now(),n=Ce().duration(t,"milliseconds").asDays();if(n<1)var r="less than a day";else r=Math.ceil(n)+" days";return(0,d.jsxs)(d.Fragment,{children:["Free trial for pro services ends in ",r,".",(0,d.jsxs)("a",{target:"_blank",href:"https://www.awesomescreenshot.com/pricing",children:[" ","Upgrade now"]})]})}return(0,d.jsxs)(d.Fragment,{children:["The 7-days free trial was expired.",(0,d.jsxs)("a",{target:"_blank",href:"https://www.awesomescreenshot.com/pricing",children:[" ","Upgrade now"]})]})}return-1===e.trailConnectedAccountExpireTimeSecond?"":0===e.trailConnectedAccountExpireTimeSecond?"7-days free trial for pro services":void 0}},{key:"handleConnect",value:function(){He(this.state.createAccount).then((function(e){var t="width=800,height=700,top="+(window.screen.availHeight-30-700)/2+",left="+(window.screen.availWidth-10-800)/2;window.open(e.URI,"",t)}))}},{key:"handlePrivacyChange",value:function(e){this.setState({createPrivacy:e.target.value})}},{key:"handleResourceChange",value:function(e){this.setState({createResource:e})}},{key:"updateCurrentResources",value:function(e){bn={},e.forEach((function(e){bn[e.id]=e})),this.setState({currentResources:e,isLoadList:!1})}},{key:"handleAccountChange",value:function(e){this.setState({currentAccount:"add"===e?null:this.props.accountHash[e]})}},{key:"getIsShowPro",value:function(){return"free"===this.props.currentPlan.PlanName||"basic"===this.props.currentPlan.PlanName}},{key:"back",value:function(){this.setState({isInAuthMode:!1})}},{key:"render",value:function(){var e=this,t=this.props.accounts,n=this.state,r=n.currentResources,i=(n.isLoadList,n.createResource,n.createPrivacy,n.createAccount),a=(n.isCreating,n.currentAccount),o=n.isShownUpgrade;return r.filter((function(e){return e.added})),r.filter((function(e){return!e.added})),(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("div",{className:"add-des-panel",children:this.state.isInAuthMode?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("div",{className:"top",children:(0,d.jsxs)("div",{className:"back-btn",onClick:this.back,children:[(0,d.jsx)(N.Z,{}),"Choose another integration"]})}),(0,d.jsx)("div",{className:"connect-panel",children:(0,d.jsxs)("div",{className:"box",children:[(0,d.jsxs)("div",{className:"main-box",children:[(0,d.jsx)("div",{className:"pic",children:(0,d.jsx)("div",{className:"logo ".concat(i)})}),(0,d.jsxs)("div",{className:"content",children:[(0,d.jsx)("div",{className:"logo ".concat(i)}),(0,d.jsxs)("div",{className:"title",children:["Integrate ",Y[i].displayName]}),(0,d.jsx)("div",{className:"sub-title",children:Y[i].panelSubTitle}),(0,d.jsx)("ul",{children:Y[i].featureLists.map((function(e,t){return(0,d.jsx)("li",{children:e},t)}))})]})]}),(0,d.jsxs)(ue.Z,{type:"primary",size:"large",onClick:this.handleConnect,children:["Connect with",Y[i].displayName]})]})})]}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("div",{className:"title",children:a?"Create a new destination":"Connect a new account"}),(t&&t.length)>0&&(0,d.jsxs)("div",{className:"account-select",children:[(0,d.jsx)("div",{className:"label",children:"Connected account"}),(0,d.jsxs)(et.Z,{value:a?a.id:"add",onChange:this.handleAccountChange,children:[t.map((function(e){var t=u()("account-logo",e.service);return(0,d.jsxs)(jn,{value:e.id,children:[(0,d.jsx)("div",{className:t}),Y[e.service].displayName,"(",e.userInfo.name,")"]},e.id)})),(0,d.jsxs)(jn,{value:"add",children:[(0,d.jsx)("div",{className:"account-logo add"}),"Connect to a new account"]})]})]}),function(){if(a)return(0,d.jsx)("div",{className:"des-select",children:(0,d.jsx)("div",{className:"account-des-select",children:"slack"===a.service?(0,d.jsx)(Ot,{currentAccount:a,handleDesCreated:e.props.handleDesCreated}):"trello"===a.service?(0,d.jsx)(Ut,{currentAccount:a,handleDesCreated:e.props.handleDesCreated}):"asana"===a.service?(0,d.jsx)(zt,{currentAccount:a,handleDesCreated:e.props.handleDesCreated}):"googleDrive"===a.service?(0,d.jsx)($t,{currentAccount:a,handleDesCreated:e.props.handleDesCreated}):"github"===a.service?(0,d.jsx)(nn,{currentAccount:a,handleDesCreated:e.props.handleDesCreated}):"jira"===a.service?(0,d.jsx)(dn,{currentAccount:a,handleDesCreated:e.props.handleDesCreated}):void 0})});var t="saveElsewhere"===e.props.servicesType?q:H;return(0,d.jsxs)("div",{className:"service-container",children:["saveElsewhere"!==e.props.servicesType&&(0,d.jsx)("div",{className:"trial-tip",children:e.getFreeTrialTip()}),(0,d.jsx)("div",{className:"label",children:"Services"}),(0,d.jsx)("div",{className:"account-container",children:t.map((function(t){var n=u()("account-item",t.name,{pro:e.getIsShowPro()});return(0,d.jsx)("div",{className:n,"data-des":t.name,onClick:e.chooseDes.bind(null,t.name),children:(0,d.jsx)("b",{})},t.name)}))})]})}()]})}),(0,d.jsx)(V.Z,{visible:o,onCancel:this.handleUpgradeCancel,type:"destination"})]})}}])&&pn(t.prototype,n),r&&pn(t,r),a}(o.Component);var wn=n(7085);const Sn=function(e){return(0,d.jsx)("div",{className:"slack-form",children:(0,d.jsxs)(Ke.Z,{onFinish:function(t){e.handleSend(t)},children:[(0,d.jsx)("div",{className:"label",children:"Message"}),(0,d.jsx)(Ke.Z.Item,{name:"description",children:(0,d.jsx)(Xe.Z.TextArea,{autoSize:{minRows:3},onChange:e.handleSlackMsgChange})}),(0,d.jsx)(Ke.Z.Item,{children:(0,d.jsx)(ue.Z,{className:"send-btn",size:"large",type:"primary",block:!0,htmlType:"submit",children:"Send message"})})]})})};n(94205);var Cn=n(68351),kn=(n(55146),n(94168)),Nn=n(58491);function On(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Dn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return In(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return In(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function In(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Tn=et.Z.Option;const Pn=function(e){var t,n=Dn((0,o.useState)(!1),2),r=n[0],i=n[1],a=Dn((0,o.useState)([]),2),s=a[0],l=a[1],c=Dn((0,o.useState)([]),2),u=c[0],h=c[1],p=Dn((0,o.useState)([]),2),f=p[0],m=p[1],v=e.resourceID,g=e.currentDes;return(0,o.useEffect)((function(){qe({accountID:g.accountID,what:"list",boardID:v}).then((function(e){l(e.items)})),qe({accountID:g.accountID,what:"member",boardID:v}).then((function(e){h(e.items)})),qe({accountID:g.accountID,what:"label",boardID:v}).then((function(e){m(e.items)}))}),[v]),(0,d.jsx)("div",{className:"trello-form",children:(0,d.jsxs)(Ke.Z,{onFinish:function(t){var n={};t.description&&(n.description=void 0===t.description?"":t.description),n.listID=t.list,t.title&&(n.title=t.title),t.members&&(n.membersID=t.members.join(",")),t.labels&&(n.labelsID=t.labels.join(",")),t.dueDate&&!t.dueTime?n.date=t.dueDate.format("YYYY-MM-DD"):t.dueDate&&t.dueTime&&(n.datetime=Ce().utc(t.dueDate.format("YYYY-MM-DD")+"T"+t.dueTime.format().replace(/(.*)T/,""))),e.handleSend(n)},children:[(0,d.jsx)("div",{className:"label",children:"List"}),(0,d.jsx)(Ke.Z.Item,{name:"list",rules:[{required:!0,message:"Please choose a list"}],initialValue:s.length?s[0].id:void 0,children:(0,d.jsx)(et.Z,{placeholder:"Please choose a list",showSearch:!0,filterOption:function(e,t){return t.name.toLowerCase().indexOf(e.toLowerCase())>=0},children:s.map((function(e){return(0,d.jsx)(Tn,{value:e.id,name:e.name,children:e.name},e.id)}))})}),(0,d.jsx)("div",{className:"label",children:"Card title"}),(0,d.jsx)(Ke.Z.Item,{name:"title",initialValue:e.tabTitle,children:(0,d.jsx)(Xe.Z,{})}),r&&(0,d.jsxs)("div",{className:"ad-fields",children:[(0,d.jsx)("div",{className:"label",children:"Description"}),(0,d.jsx)(Ke.Z.Item,{name:"description",children:(0,d.jsx)(Xe.Z.TextArea,{autoSize:{minRows:3}})}),(0,d.jsx)("div",{className:"label",children:"Members"}),(0,d.jsx)(Ke.Z.Item,{name:"members",children:(0,d.jsx)(et.Z,{mode:"multiple",style:{width:"100%"},placeholder:"Select members",showSearch:!0,filterOption:function(e,t){return t.name.toLowerCase().indexOf(e.toLowerCase())>=0},children:u.map((function(e){return(0,d.jsx)(Tn,{value:e.id,name:e.name,children:e.name},e.id)}))})}),(0,d.jsx)("div",{className:"label",children:"Labels"}),(0,d.jsx)(Ke.Z.Item,{name:"labels",children:(0,d.jsx)(et.Z,(t={mode:"multiple",style:{width:"100%"},placeholder:"Select a label",className:"label-select"},On(t,"className","trello-member-select"),On(t,"showSearch",!0),On(t,"filterOption",(function(e,t){return t.name.toLowerCase().indexOf(e.toLowerCase())>=0})),On(t,"children",f.map((function(e){return(0,d.jsx)(Tn,{value:e.id,name:e.name,children:(0,d.jsx)("div",{className:"trello-label-item "+e.info.color,children:e.name})},e.id)}))),t))}),(0,d.jsxs)("div",{className:"half-form",children:[(0,d.jsxs)("div",{className:"half",children:[(0,d.jsx)("div",{className:"label",children:"Due Date"}),(0,d.jsx)(Ke.Z.Item,{name:"dueDate",children:(0,d.jsx)(kn.Z,{})})]}),(0,d.jsxs)("div",{className:"half",children:[(0,d.jsx)("div",{className:"label",children:"Due Time"}),(0,d.jsx)(Ke.Z.Item,{name:"dueTime",children:(0,d.jsx)(Cn.Z,{use12Hours:!0,format:"h:mm A",className:"due-time-picker"})})]})]})]}),(0,d.jsx)("div",{className:"toggle-field",children:(0,d.jsx)("a",{className:"toggle-fields-btn",onClick:function(){i(!r)},children:r?(0,d.jsxs)(d.Fragment,{children:["Collapse all fields ",(0,d.jsx)(Nn.Z,{})]}):(0,d.jsxs)(d.Fragment,{children:["Show all fields ",(0,d.jsx)(be.Z,{})]})})}),(0,d.jsx)("div",{children:(0,d.jsx)(ue.Z,{className:"send-btn",size:"large",type:"primary",block:!0,htmlType:"submit",children:"Create card"})})]})})};function An(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Zn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Zn(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Zn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Un=et.Z.Option;const En=function(e){var t=An((0,o.useState)(!1),2),n=t[0],r=t[1],i=An((0,o.useState)([]),2),a=i[0],s=i[1],l=An((0,o.useState)([]),2),c=l[0],u=l[1],h=An((0,o.useState)([]),2),p=h[0],f=h[1],m=e.currentDes,v=m.info.workspaceID,g=m.resourceID;return(0,o.useEffect)((function(){qe({accountID:m.accountID,what:"section",projectID:g}).then((function(e){s(e.items)})),qe({accountID:m.accountID,what:"member",projectID:g}).then((function(e){u(e.items)})),qe({accountID:m.accountID,what:"tag",workspaceID:v}).then((function(e){f(e.items)}))}),[g]),(0,d.jsx)("div",{className:"trello-form",children:(0,d.jsxs)(Ke.Z,{onFinish:function(t){var n={};t.description&&(n.description=t.description),t.section&&"-1"!==t.section&&(n.sectionID=t.section),t.title&&(n.title=t.title),t.tags&&(n.tagsID=t.tags.join(",")),t.assignee&&(n.assigneeID=t.assignee),t.dueDate&&!t.dueTime?n.date=t.dueDate.format("YYYY-MM-DD"):t.dueDate&&t.dueTime&&(n.datetime=Ce().utc(t.dueDate.format("YYYY-MM-DD")+"T"+t.dueTime.format().replace(/(.*)T/,""))),e.handleSend(n)},children:[(0,d.jsx)("div",{className:"label",children:"list"===m.info.layout?"Section":"Column"}),(0,d.jsx)(Ke.Z.Item,{name:"section",initialValue:"list"!==m.info.layout?a.length?a[0].id:null:"-1",children:(0,d.jsxs)(et.Z,{children:["list"===m.info.layout&&(0,d.jsx)(Un,{value:"-1",children:"No section"}),a.map((function(e){return(0,d.jsx)(Un,{value:e.id,children:e.name},e.id)}))]})}),(0,d.jsx)("div",{className:"label",children:"Task name"}),(0,d.jsx)(Ke.Z.Item,{name:"title",initialValue:e.tabTitle,children:(0,d.jsx)(Xe.Z,{})}),n&&(0,d.jsxs)("div",{className:"ad-fields",children:[(0,d.jsx)("div",{className:"label",children:"Description"}),(0,d.jsx)(Ke.Z.Item,{name:"description",children:(0,d.jsx)(Xe.Z.TextArea,{autoSize:{minRows:3}})}),(0,d.jsx)("div",{className:"label",children:"Assignee"}),(0,d.jsx)(Ke.Z.Item,{name:"assignee",children:(0,d.jsx)(et.Z,{style:{width:"100%"},placeholder:"Please select assignee",children:c.map((function(e){return(0,d.jsx)(Un,{value:e.id,children:e.name},e.id)}))})}),(0,d.jsx)("div",{className:"label",children:"Tags"}),(0,d.jsx)(Ke.Z.Item,{name:"tags",children:(0,d.jsx)(et.Z,{mode:"multiple",style:{width:"100%"},placeholder:"Please select",children:p.map((function(e){return(0,d.jsx)(Un,{value:e.id,children:e.name},e.id)}))})}),(0,d.jsxs)("div",{className:"half-form",children:[(0,d.jsxs)("div",{className:"half",children:[(0,d.jsx)("div",{className:"label",children:"Due Date"}),(0,d.jsx)(Ke.Z.Item,{name:"dueDate",children:(0,d.jsx)(kn.Z,{})})]}),(0,d.jsxs)("div",{className:"half",children:[(0,d.jsx)("div",{className:"label",children:"Due Time"}),(0,d.jsx)(Ke.Z.Item,{name:"dueTime",children:(0,d.jsx)(Cn.Z,{use12Hours:!0,format:"h:mm A",className:"due-time-picker"})})]})]})]}),(0,d.jsx)("div",{className:"toggle-field",children:(0,d.jsx)("a",{className:"toggle-fields-btn",onClick:function(){r(!n)},children:n?(0,d.jsxs)(d.Fragment,{children:["Collapse all fields ",(0,d.jsx)(Nn.Z,{})]}):(0,d.jsxs)(d.Fragment,{children:["Show all fields ",(0,d.jsx)(be.Z,{})]})})}),(0,d.jsx)("div",{children:(0,d.jsx)(ue.Z,{className:"send-btn",size:"large",type:"primary",block:!0,htmlType:"submit",children:"Create task"})})]})})};const Rn=function(e){var t=e.tabTitle;return(0,d.jsx)("div",{className:"slack-form",children:(0,d.jsxs)(Ke.Z,{onFinish:function(t){e.handleSend(values)},children:[(0,d.jsx)("div",{className:"label",children:"Name"}),(0,d.jsx)(Ke.Z.Item,{name:"title",initialValue:t,children:(0,d.jsx)(Xe.Z,{onChange:e.handleSlackMsgChange})}),(0,d.jsx)("div",{children:(0,d.jsx)(ue.Z,{className:"send-btn",size:"large",type:"primary",block:!0,htmlType:"submit",children:"Upload image"})})]})})};function _n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Fn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Fn(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Fn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Mn=et.Z.Option;const Ln=function(e){var t=_n((0,o.useState)(!1),2),n=t[0],r=t[1],i=_n((0,o.useState)([]),2),a=i[0],s=i[1],l=_n((0,o.useState)([]),2),c=l[0],u=l[1],h=e.resourceID,p=e.currentDes;return(0,o.useEffect)((function(){qe({accountID:p.accountID,what:"assignee",repo:p.resourceName,owner:p.info.owner}).then((function(e){s(e.items)})),qe({accountID:p.accountID,what:"label",repo:p.resourceName,owner:p.info.owner}).then((function(e){u(e.items)}))}),[h]),(0,d.jsx)("div",{className:"github-form",children:(0,d.jsxs)(Ke.Z,{onFinish:function(t){var n={};t.description&&(n.description=void 0===t.description?"":t.description),n.listID=t.list,t.title&&(n.title=t.title),t.assignees&&(n.assignees=t.assignees.join(",")),t.labels&&(n.labels=t.labels.join(",")),e.handleSend(n)},children:[(0,d.jsx)("div",{className:"label",children:"Issue title"}),(0,d.jsx)(Ke.Z.Item,{name:"title",initialValue:e.tabTitle,children:(0,d.jsx)(Xe.Z,{})}),n&&(0,d.jsxs)("div",{className:"ad-fields",children:[(0,d.jsx)("div",{className:"label",children:"Description"}),(0,d.jsx)(Ke.Z.Item,{name:"description",children:(0,d.jsx)(Xe.Z.TextArea,{autoSize:{minRows:3}})}),(0,d.jsx)("div",{className:"label",children:"Assignee"}),(0,d.jsx)(Ke.Z.Item,{name:"assignees",children:(0,d.jsx)(et.Z,{mode:"multiple",style:{width:"100%"},placeholder:"Assign a member",children:a.map((function(e){return(0,d.jsx)(Mn,{value:e.name,children:e.name},e.id)}))})}),(0,d.jsx)("div",{className:"label",children:"Labels"}),(0,d.jsx)(Ke.Z.Item,{name:"labels",children:(0,d.jsx)(et.Z,{mode:"multiple",style:{width:"100%"},placeholder:"Select a label",className:"label-select",children:c.map((function(e){var t={backgroundColor:"#"+e.info.color};return"ffffff"===e.info.color&&(t.color="black",t.border="1px solid #eee"),(0,d.jsx)(Mn,{value:e.name,children:(0,d.jsx)("div",{style:t,className:"trello-label-item",children:e.name})},e.id)}))})})]}),(0,d.jsx)("div",{className:"toggle-field",children:(0,d.jsx)("a",{className:"toggle-fields-btn",onClick:function(){r(!n)},children:n?(0,d.jsxs)(d.Fragment,{children:["Collapse all fields ",(0,d.jsx)(Nn.Z,{})]}):(0,d.jsxs)(d.Fragment,{children:["Show all fields ",(0,d.jsx)(be.Z,{})]})})}),(0,d.jsx)("div",{children:(0,d.jsx)(ue.Z,{className:"send-btn",size:"large",type:"primary",block:!0,htmlType:"submit",children:"Create issue"})})]})})};n(41470);var Bn=n(11382),zn=(n(23364),n(51368)),Yn=et.Z.Option;function Wn(e){var t=e.field,n=t.allowedValues,r=t.defaultValue,i=-1!==t.operations.indexOf("add")?"multiple":void 0;return(0,d.jsx)(et.Z,{defaultValue:r?r.id:void 0,mode:i,onChange:function(r){var i=r;"customfield_10021"===t.key&&(i=r.map((function(e){return function(e){var t=null;return n.forEach((function(n){n.id===e&&(t=n)})),t}(e)}))),e.handleChange(t.key,i)},children:n.map((function(e){return(0,d.jsx)(Yn,{value:e.id,children:e.name||e.value},e.id)}))})}function Hn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return qn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return qn(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function qn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Gn=et.Z.Option;function Vn(e){var t=Hn((0,o.useState)([]),2),n=t[0],r=t[1],i=e.field,a=e.currentDes;(0,o.useEffect)((function(){qe({accountID:a.accountID,what:"autoComplete",fieldName:i.key,cloudID:a.info.cloudID,projectID:a.info.projectID}).then((function(e){r(e.items?e.items:[])}))}),[]);var s=-1!==i.operations.indexOf("add")?"multiple":void 0;return(0,d.jsx)(et.Z,{mode:s,onChange:function(t){e.handleChange(i.key,t)},children:n.map((function(e){return function(e){return"assignee"===i.key?(0,d.jsx)(Gn,{value:e.info.user.accountId,children:e.info.user.displayName},e.info.user.accountId):"reporter"===i.key?(0,d.jsx)(Gn,{value:e.id,children:e.info.field.displayName},e.id):"labels"===i.key?(0,d.jsx)(Gn,{value:e.info.field.value,children:e.info.field.displayName},e.info.field.value):(0,d.jsx)(Gn,{})}(e)}))})}var $n=n(23279),Jn=n.n($n),Kn=n(93695);function Xn(e){return function(e){if(Array.isArray(e))return tr(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||er(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Qn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}(e,t)||er(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function er(e,t){if(e){if("string"==typeof e)return tr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?tr(e,t):void 0}}function tr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var nr=et.Z.Option;function rr(e){var t=Qn((0,o.useState)([{id:Date.now(),linkType:"",issues:[]}]),2),n=t[0],r=t[1],i=Qn((0,o.useState)([]),2),a=i[0],s=i[1],l=Qn((0,o.useState)([]),2),c=l[0],u=l[1],h=(e.field,e.currentDes);(0,o.useEffect)((function(){qe({accountID:h.accountID,what:"issueLinkType",cloudID:h.info.cloudID,projectID:h.info.projectID}).then((function(e){var t=[];e.items.forEach((function(e){"Relates"===e.name?t.push({value:e.name+"+in",displayName:e.info.inward}):(t.push({value:e.name+"+in",displayName:e.info.inward}),t.push({value:e.name+"+out",displayName:e.info.outward}))})),s(t)}))}),[]),(0,o.useEffect)((function(){e.handleChange("issuelinks",n)}),[n]);var p=function(e,t){qe({accountID:h.accountID,what:"issue",cloudID:h.info.cloudID,query:t}).then((function(e){e.items[0].info.issues.length>0&&u(e.items[0].info.issues)}))};return(0,d.jsxs)("div",{className:"issue-link",children:[(0,d.jsxs)("div",{className:"label",children:["Linked issues",(0,d.jsx)("div",{className:"add-btn",onClick:function(){r([].concat(Xn(n),[{id:Date.now(),linkType:"",issues:[]}]))},children:(0,d.jsx)(se.Z,{title:"Add",children:(0,d.jsx)(tt.Z,{})})})]}),(0,d.jsx)("div",{className:"issue-link-container",children:n.map((function(e,t){return(0,d.jsxs)("div",{className:"issue-link-item",children:[(0,d.jsx)(et.Z,{className:"issue-link-type-select",placeholder:"Link type",onChange:function(t){!function(e,t){var i=n.filter((function(t){return t.id===e}));i[0].linkType=t;var a=n.map((function(t){return t.id===e?i[0]:t}));r(a)}(e.id,t)},children:a.map((function(e){return(0,d.jsx)(nr,{value:e.value,children:e.displayName},e.value)}))}),(0,d.jsx)(et.Z,{className:"issue-link-select",placeholder:"Select issues",mode:"multiple",onSearch:Jn()((function(t){return p(e.id,t)}),800),onDropdownVisibleChange:function(t){t&&p(e.id,"")},onChange:function(t){return function(e,t){var i=n.filter((function(t){return t.id===e}));i[0].issues=t;var a=n.map((function(t){return t.id===e?i[0]:t}));r(a)}(e.id,t)},children:c.map((function(e){return(0,d.jsx)(nr,{value:e.key,children:e.key},e.key)}))}),(0,d.jsx)("div",{className:"issue-link-remove",onClick:function(){var t;t=e.id,r(n.filter((function(e){return e.id!==t})))},children:(0,d.jsx)(se.Z,{title:"Remove",children:(0,d.jsx)(Kn.Z,{})})})]},e.id)}))})]})}function ir(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ar(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ar(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ar(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var or=et.Z.Option;function sr(e){var t=ir((0,o.useState)([]),2),n=t[0],r=t[1],i=e.field,a=e.currentDes;(0,o.useEffect)((function(){}),[]);var s=function(e){var t;qe({accountID:a.accountID,what:(t=i.key,"customfield_10014"===t?"epic":"customfield_10021"==t?"sprint":void 0),cloudName:a.info.cloudName,query:e,cloudID:a.info.cloudID,projectID:a.info.projectID}).then((function(e){r(e.items?e.items:[])}))},l=-1!==i.operations.indexOf("add")?"multiple":void 0;return(0,d.jsx)(et.Z,{showSearch:!0,mode:l,filterOption:!1,onChange:function(t){e.handleChange(i.key,t)},onSearch:Jn()(s,800),onDropdownVisibleChange:function(e){e&&s("")},children:n.map((function(e){return function(e){return"customfield_10021"===i.key?(0,d.jsxs)(or,{value:e.id,children:[e.name,"(",e.info.data.stateKey,")"]},e.id):"customfield_10014"===i.key?(0,d.jsxs)(or,{value:e.id,children:[e.name,"-(",e.id,")"]},e.id):(0,d.jsx)(or,{})}(e)}))})}function lr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return cr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return cr(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function cr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}const ur=function(e){var t=lr((0,o.useState)(!1),2),n=t[0],r=t[1],i=e.currentDes;return(0,d.jsxs)("div",{className:"jira-api-token-panel",children:[(0,d.jsxs)("div",{className:"info",children:["Go to your Atlassian"," ",(0,d.jsx)("a",{href:"https://id.atlassian.com/manage/api-tokens",target:"_blank",children:"API tokens page"})," ","and create a new API token. Copy the token and paste it into the box below."]}),(0,d.jsxs)(Ke.Z,{onSubmit:function(t){var n,a;r(!0),(n=i.account.id,a=t.token,Ye({method:"POST",url:"/account/jira_basic_token",data:{accountID:n,token:a}})).then((function(){r(!1),e.handleApiTokenSubmitted()})).catch((function(){r(!1)}))},children:[(0,d.jsx)("div",{className:"label",children:"API TOKEN"}),(0,d.jsx)(Ke.Z.Item,{name:"token",rules:[{required:!0}],children:(0,d.jsx)(Xe.Z,{})}),(0,d.jsx)(Ke.Z.Item,{children:(0,d.jsx)(ue.Z,{type:"primary",block:!0,loading:n,htmlType:"submit",children:"Submit"})})]})]})};function dr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function hr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?dr(Object(n),!0).forEach((function(t){pr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):dr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function pr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function fr(e){return(0,d.jsx)(r.Z,hr(hr({},e),{},{footer:null,maskClosable:!1,wrapClassName:"jira-api-token",destroyOnClose:!0,centered:!0,title:"Submit Jira API token",children:(0,d.jsx)(ur,hr({},e))}))}function mr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function vr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?mr(Object(n),!0).forEach((function(t){gr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):mr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function gr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function yr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return br(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return br(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function br(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var jr=et.Z.Option,xr={};const wr=function(e){var t=yr((0,o.useState)(!1),2),n=t[0],r=t[1],i=yr((0,o.useState)({}),2),a=i[0],s=i[1],c=yr((0,o.useState)([]),2),u=c[0],h=c[1],p=yr((0,o.useState)(null),2),f=p[0],m=p[1],v=yr((0,o.useState)(!1),2),g=v[0],y=v[1],b=e.currentDes;(0,o.useEffect)((function(){u.length&&h([]),qe({accountID:b.accountID,what:"createMeta",cloudID:b.info.cloudID,projectID:b.info.projectID}).then((function(e){m(e.items[0]),h(e.items),e.items.forEach((function(e){xr[e.id]=e}))}))}),[e.currentDes]),(0,o.useEffect)((function(){}));var j,x=function(e,t){s(vr(vr({},a),{},gr({},e,t)))},w=function(e){var t={fields:{}},n={};for(var r in n.project={id:b.info.projectID},e)"issuetype"===r||"priority"===r||"assignee"===r?n[r]={id:e[r]}:"summary"===r||"description"===r||"environment"===r||"customfield_10014"===r||"customfield_10016"===r||"labels"===r||"customfield_10037"===r||"customfield_10038"===r||"customfield_10039"===r||"customfield_10029"===r||"customfield_10034"===r||"customfield_10035"===r||"customfield_10036"===r||"customfield_10031"===r||"customfield_10032"===r||"customfield_10033"===r||"customfield_10021"===r?e[r]&&(n[r]=e[r]):"components"===r?n[r]=e[r].map((function(e){return{id:e}})):"customfield_10026"===r?e[r]&&(n[r]=[{id:f.info.fields.customfield_10026.allowedValues[0].id}]):"fixVersions"===r?n[r]=e[r].map((function(e){return{id:e}})):"reporter"===r?e[r]&&(n[r]={id:e[r]}):"parent"===r?e[r]&&(n[r]={key:e[r]}):"duedate"!==r&&"customfield_10015"!==r&&"customfield_10030"!==r||e[r]&&(n[r]=e[r].format());return(e["timetracking-o"]||e["timetracking-r"])&&(n.timetracking={}),e["timetracking-o"]&&(n.timetracking.originalEstimate=e["timetracking-o"]),e["timetracking-r"]&&(n.timetracking.remainingEstimate=e["timetracking-r"]),t.fields=n,e.issuelinks&&e.issuelinks.length&&(t.issueLinks=[],e.issuelinks.forEach((function(e){if(e.linkType&&e.issues.length){var n=e.linkType.split("+"),r=n[0],i=n[1];e.issues.forEach((function(e){var n=gr({type:r},"".concat(i,"wardIssue"),e);t.issueLinks.push(n)}))}}))),t},S=function(e){return"timetracking"===e.key?"(eg. 3w 4d 12h)":""},C=function(){y(!0)},k=function(e){return void 0!==e.allowedValues?(0,d.jsx)(Wn,{handleChange:x,field:e}):void 0!==e.autoCompleteUrl?(0,d.jsx)(Vn,{handleChange:x,currentDes:b,field:e}):"description"===e.key||"environment"===e.key?(0,d.jsx)(Ke.Z.Item,{name:e.key,children:(0,d.jsx)(Xe.Z.TextArea,{autoSize:{minRows:3}})}):"customfield_10014"===e.key?(0,d.jsx)(sr,{handleChange:x,currentDes:b,field:e}):"customfield_10021"===e.key?f.info.apiToken?(0,d.jsx)(sr,{handleChange:x,currentDes:b,field:e}):(0,d.jsx)(d.Fragment,{children:(0,d.jsxs)("i",{className:"jira-sprint-tip",children:["To use Sprint, you need to provide an API token."," ",(0,d.jsx)("a",{onClick:C,children:"Submit API token"})]})}):(0,d.jsx)(Ke.Z.Item,{name:e.key,children:(0,d.jsx)(Xe.Z,{placeholder:S(e)})})};return(0,d.jsxs)("div",{className:"jira-form",children:[0===u.length?(0,d.jsx)("div",{className:"loading",children:(0,d.jsx)(Bn.Z,{indicator:(0,d.jsx)(wn.Z,{spin:!0})})}):(0,d.jsxs)(Ke.Z,{onFinish:function(t){var n=vr(vr({},t),a),r=w(n),i=f.info.fields;i.environment&&!r.fields.environment&&(r.fields.environment=""),i.description&&!r.fields.description&&(r.fields.description=""),e.handleSend(r)},children:[(0,d.jsx)("div",{className:"label",children:"Issue Type"}),(0,d.jsx)(Ke.Z.Item,{name:"issuetype",initialValue:u[0].id,children:(0,d.jsx)(et.Z,{onChange:function(e,t){m(xr[e])},children:u.map((function(e){if("Subtask"!==e.name)return(0,d.jsx)(jr,{value:e.id,children:e.name},e.id)}))})}),(0,d.jsx)("div",{className:"label",children:"Summary"}),(0,d.jsx)(Ke.Z.Item,{name:"summary",rules:[{required:!0,message:"You must specify a summary of the issue."}],children:(0,d.jsx)(Xe.Z,{})}),n&&(j=f.info.fields,(0,d.jsx)(d.Fragment,{children:Object.keys(j).map((function(e){return"issuetype"===e||"project"===e||"summary"===e||"attachment"===e?void 0:"timetracking"===e?(0,d.jsxs)("div",{children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{className:"label",children:"Original Estimate"}),(0,d.jsx)(Ke.Z.Item,{name:"timetracking-o",children:(0,d.jsx)(Xe.Z,{placeholder:"(eg. 3w 4d 12h)"})})]},"oe"),(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{className:"label",children:"Remaining Estimate"}),(0,d.jsx)(Ke.Z.Item,{name:"timetracking-r",children:(0,d.jsx)(Xe.Z,{placeholder:"(eg. 3w 4d 12h)"})})]},"re")]},j[e].key):"issuelinks"===e?(0,d.jsx)("div",{children:(0,d.jsx)(rr,{handleChange:x,currentDes:b,field:j})},j[e].key):"duedate"===e||"customfield_10030"===e||"customfield_10015"===e?(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{className:"label",children:j[e].name}),(0,d.jsx)(Ke.Z.Item,{name:e,children:(0,d.jsx)(kn.Z,{style:{width:"100%"}})})]},j[e].key):"customfield_10022"===e||"customfield_10017"===e?"":"customfield_10016"===e?(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{className:"label",children:j[e].name}),(0,d.jsx)(Ke.Z.Item,{name:e,children:(0,d.jsx)(zn.Z,{style:{width:"100%"}})})]},j[e].key):"customfield_10026"===e?(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{className:"label",children:j[e].name}),(0,d.jsx)(Ke.Z.Item,{name:e,children:(0,d.jsx)(l.Z,{children:j[e].allowedValues[0].value})})]},j[e].key):(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{className:"label",children:j[e].name}),k(j[e])]},j[e].key)}))})),(0,d.jsx)("div",{className:"toggle-field",children:(0,d.jsx)("a",{className:"toggle-fields-btn",onClick:function(){r(!n)},children:n?(0,d.jsxs)(d.Fragment,{children:["Collapse all fields ",(0,d.jsx)(Nn.Z,{})]}):(0,d.jsxs)(d.Fragment,{children:["Show all fields ",(0,d.jsx)(be.Z,{})]})})}),(0,d.jsx)("div",{children:(0,d.jsx)(ue.Z,{className:"send-btn",size:"large",type:"primary",block:!0,htmlType:"submit",children:"Create issue"})})]}),(0,d.jsx)(fr,{visible:g,onCancel:function(){y(!1)},currentDes:b,handleApiTokenSubmitted:function(){y(!1),u.length&&h([]),qe({accountID:b.accountID,what:"createMeta",cloudID:b.info.cloudID,projectID:b.info.projectID}).then((function(e){m(e.items[0]),h(e.items),e.items.forEach((function(e){xr[e.id]=e}))}))}})]})};function Sr(e){return(Sr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Cr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function kr(e,t){return(kr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Nr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ir(e);if(t){var i=Ir(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Or(this,n)}}function Or(e,t){return!t||"object"!==Sr(t)&&"function"!=typeof t?Dr(e):t}function Dr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ir(e){return(Ir=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Tr=et.Z.Option;const Pr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&kr(e,t)}(s,e);var t,n,r,o=Nr(s);function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=o.call(this,e)).state={currentDesId:t.props.currentDes.id,slackMsg:"",isUploading:!1,percentage:0},t.handleDesChange=t.handleDesChange.bind(Dr(t)),t.handleSend=t.handleSend.bind(Dr(t)),t.handleSlackMsgChange=t.handleSlackMsgChange.bind(Dr(t)),t.onUploadProgress=t.onUploadProgress.bind(Dr(t)),t}return t=s,(n=[{key:"handleDesChange",value:function(e){"add"!==e?this.setState({currentDesId:e}):this.props.goToAddDes()}},{key:"onUploadProgress",value:function(e){this.setState({percentage:e})}},{key:"handleSend",value:function(e){var t=this,n=this.props.destinations,r=this.state.currentDesId,o={};n.forEach((function(e){o[e.id]=e}));var s=o[r];e.service=s.service,e.destinationID=r+"";var l,c=e.description;if(this.props.tabUrl&&(e.sourceLink=this.props.tabUrl),"trello"===e.service?e.extraString=function(e){if(!e)return"";var t="";for(var n in e)t+="**"+n+"**: "+e[n]+" \n";return t}(this.props.imageInfo):"asana"===e.service?e.extraString=function(e){if(!e)return"";var t="";return t+"Captured in "+e.Browser+", "+e["Viewport Size"]+" viewport, "+e["Pixel Ratio"]+" pixel ratio, "+e["Zoom Level"]+" zoom, "+e.OS}(this.props.imageInfo):"github"===e.service?e.extraString=function(e){if(!e)return"";var t="<table>";for(var n in e)t+="<tr><td><strong>"+n+"</strong></td><td>"+e[n]+"</td></tr>";return t+"</table> \n"}(this.props.imageInfo):"jira"===e.service&&(void 0!==e.fields.environment?(e.fields.environment=De(e.fields.environment,this.props.imageInfo,this.props.itemUrl,this.props.type),void 0!==e.fields.description&&(e.fields.description={version:1,type:"doc",content:[{type:"paragraph",content:[{type:"text",text:e.fields.description}]}]})):void 0!==e.fields.description&&(e.fields.description=De(e.fields.description,this.props.imageInfo,this.props.itemUrl,this.props.type))),this.props.itemId)"video"===this.props.type?e.videoID=this.props.itemId:e.imageID=this.props.itemId,this.setState({isUploading:!0}),(l=e,Ye({method:"POST",url:"/account/share_item",data:l})).then((function(n){i.Z.success({message:Y[e.service].successMsg,description:(0,d.jsxs)("a",{href:n.itemUrl,target:"_blank",children:["Click to see it in your ",Y[e.service].displayName]})}),t.props.handleSendSuccess()}),(function(e){throw new Error(Y[s.service].actionTypeStr+" failed! ("+e+")")})).catch((function(e){e&&a.ZP.error(e.toString()+" Please try again!"),t.setState({isUploading:!1,percentage:0})}));else{if(this.props.imageBlob)var u=this.props.contentType;else{var h=this.props.imageUrl.split(",")[1];u=this.props.imageUrl.split(",")[0].split(":")[1].split(";")[0]}this.setState({isUploading:!0}),function(e){return Ye({method:"POST",url:"/destination/image/create",data:e})}({Title:e.title||"",Description:c,DestID:this.state.currentDesId+"",ContentType:u}).then((function(n){var r=t.props.imageBlob?t.props.imageBlob:ke(h,u),a=new File([r],"test.png"),o=n.Image.S3Key;return e.destinationImageID=n.Image.ImageID+"",e.imageURL=Be+"/destination/image/show?ImageKey="+o,e.imageName=t.props.tabTitle+"."+u.replace("image/",""),function(e,t,n){var r=new FormData;for(var i in e)r.append(i,e[i]);var a=n||"https://awesomescreenshot.s3.amazonaws.com/";return we()({method:"POST",crossdomain:!0,url:a,data:r,onUploadProgress:function(e){var n=Math.round(100*e.loaded/e.total);t(n)}})}({AWSAccessKeyId:"AKIAJSCJQ2NM3XLFPVKA",acl:"private",key:n.Image.S3Key,"Content-Type":u,policy:n.Policy,signature:n.Signature,file:a},t.onUploadProgress).then((function(n){return function(e){return Ye({method:"GET",url:"/destination/image/upload_done",params:{key:e}})}(o).then((function(n){return function(e){return Ye({method:"POST",url:"/account/share_screenshot",data:e})}(e).then((function(n){i.Z.success({message:Y[e.service].successMsg,description:(0,d.jsxs)("a",{href:n.itemUrl,target:"_blank",children:["Click to see it in your"," ",Y[e.service].displayName]})}),t.props.handleSendSuccess()}),(function(e){throw new Error(Y[s.service].actionTypeStr+" failed! ("+e+")")}))}))}),(function(e){throw new Error("Upload image failed!")}))}),(function(e){throw new Error("Create image error!("+e+")")})).catch((function(e){e&&a.ZP.error(e.toString()+" Please try again!"),t.setState({isUploading:!1,percentage:0})}))}}},{key:"handleSlackMsgChange",value:function(e){this.setState({slackMsg:e.currentTarget.value})}},{key:"render",value:function(){var e=this,t=this.props,n=t.destinations,r=t.itemUrl,i=this.state,a=i.currentDesId,o=i.isUploading,s=i.percentage,l={};n.forEach((function(e){l[e.id]=e}));var c=l[a],h=u()("upload-progress",{active:o}),p=u()("destination-area",{active:!o});return(0,d.jsxs)("div",{className:"des-panel",children:[(0,d.jsx)("div",{className:"title",children:Y[c.service].panelTitle}),(0,d.jsxs)("div",{className:h,children:[r?(0,d.jsx)(wn.Z,{className:"loading"}):(0,d.jsx)(Qe.Z,{type:"circle",status:"active",percent:s}),(0,d.jsx)("div",{className:"upload-tip",children:s<100&&!r?"Uploading image...":Y[c.service].actionTypeStr+"..."})]}),(0,d.jsxs)("div",{className:p,children:[(0,d.jsxs)("div",{className:"destination-select",children:[(0,d.jsx)("div",{className:"label",children:"Destination"}),(0,d.jsxs)(et.Z,{value:a,onChange:this.handleDesChange,children:[n.map((function(e){var t=u()("des-logo",e.service);return(0,d.jsxs)(Tr,{value:e.id,children:[(0,d.jsx)("div",{className:t}),W[e.resourceType]+e.resourceName]},e.id)})),(0,d.jsxs)(Tr,{value:"add",children:[(0,d.jsx)("div",{className:"des-logo add"}),"Create a new destination"]},"add")]})]}),(0,d.jsx)("div",{className:"des-form",children:"slack"===c.service?(0,d.jsx)(Sn,{currentDes:c,tabTitle:e.props.tabTitle,handleSend:e.handleSend,handleSlackMsgChange:e.handleSlackMsgChange}):"trello"===c.service?(0,d.jsx)(Pn,{currentDes:c,tabTitle:e.props.tabTitle,resourceID:c.resourceID,handleSend:e.handleSend}):"asana"===c.service?(0,d.jsx)(En,{tabTitle:e.props.tabTitle,currentDes:c,handleSend:e.handleSend}):"googleDrive"===c.service?(0,d.jsx)(Rn,{tabTitle:e.props.tabTitle,currentDes:c,handleSend:e.handleSend}):"github"===c.service?(0,d.jsx)(Ln,{tabTitle:e.props.tabTitle,currentDes:c,handleSend:e.handleSend}):"jira"===c.service?(0,d.jsx)(wr,{tabTitle:e.props.tabTitle,currentDes:c,handleSend:e.handleSend}):void 0})]})]})}}])&&Cr(t.prototype,n),r&&Cr(t,r),s}(o.Component);function Ar(e){return(Ar="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Zr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ur(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Zr(Object(n),!0).forEach((function(t){Er(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Zr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Er(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Rr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _r(e,t){return(_r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Fr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Lr(e);if(t){var i=Lr(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Mr(this,n)}}function Mr(e,t){return!t||"object"!==Ar(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Lr(e){return(Lr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}const Br=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_r(e,t)}(o,e);var t,n,i,a=Fr(o);function o(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),a.call(this,e)}return t=o,(n=[{key:"render",value:function(){var e=this,t=this.props.currentPanel;return(0,d.jsx)(r.Z,Ur(Ur({},this.props),{},{footer:null,maskClosable:!1,wrapClassName:"des",destroyOnClose:!0,centered:!0,children:"add"===t?(0,d.jsx)(xn,Ur(Ur({},e.props),{},{currentAccount:e.props.defaultCurrentAccount})):"des"===t?(0,d.jsx)(Pr,{currentDes:e.props.currentDes,destinations:e.props.destinations,goToAddDes:e.props.goToAddDes,tabTitle:e.props.tabTitle,tabUrl:e.props.tabUrl,imageUrl:e.props.imageUrl,imageBlob:e.props.imageBlob,imageInfo:e.props.imageInfo||null,handleSendSuccess:e.props.onCancel,contentType:e.props.contentType,type:e.props.type,itemId:e.props.itemId,itemUrl:e.props.itemUrl}):void 0}))}}])&&Rr(t.prototype,n),i&&Rr(t,i),o}(o.Component);function zr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Yr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?zr(Object(n),!0).forEach((function(t){Wr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Wr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Hr(e){return(0,d.jsx)(r.Z,Yr(Yr({},e),{},{footer:null,maskClosable:!1,wrapClassName:"what-des",destroyOnClose:!0,children:"what is a destination?"}))}function qr(e){var t=e.destinations,n=u()("des-container",{small:e.small});return(0,d.jsx)("div",{className:"render-des",children:t&&t.length?(0,d.jsxs)("div",{className:n,children:[t.map((function(t,n){var r=u()("des-item",t.service);return(0,d.jsxs)("div",{className:r,onClick:e.handleDesClick.bind(null,t),title:Y[t.service].displayName+" ("+W[t.resourceType]+t.resourceName+")",children:[(0,d.jsx)("div",{className:"icon"}),(0,d.jsx)("div",{className:"name",children:W[t.resourceType]+t.resourceName})]},n)})),(0,d.jsx)("div",{className:"des-item add",onClick:e.handleDesClick.bind(null,"add"),children:(0,d.jsx)("div",{className:"icon",children:"+"})})]}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(ue.Z,{type:"primary",className:"feedback-btn",block:!0,onClick:e.handleAddDesClick,children:"Connect with other services"}),(0,d.jsxs)("div",{className:"support-s",children:[(0,d.jsx)("div",{children:"Support:"}),(0,d.jsx)("div",{className:"s-container",children:H.map((function(e){return(0,d.jsx)(se.Z,{title:e.displayName,children:(0,d.jsx)("div",{className:"s-item ".concat(e.name)})},e.name)}))})]})]})})}var Gr=n(85483);function Vr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return $r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return $r(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Jr=et.Z.Option;const Kr=function(e){var t=e.accounts,n=e.currentDriveAccount,r=n?n.service:"googleDrive",s=Y[r],c=Vr((0,o.useState)((function(){return t?t[0]:null})),2),h=(c[0],c[1]),p=Vr((0,o.useState)(""),2),f=p[0],m=p[1],v=Vr((0,o.useState)(!0),2),g=v[0],y=v[1],b=Vr((0,o.useState)([]),2),j=b[0],x=b[1],w=Vr((0,o.useState)(!1),2),S=w[0],C=w[1],k=Vr((0,o.useState)((function(){return null===e.currentDriveAccount})),2),O=(k[0],k[1],Vr((0,o.useState)(!1),2)),D=O[0],I=O[1],T=Vr((0,o.useState)(0),2),P=T[0],A=T[1],Z=Vr((0,o.useState)(!1),2),U=Z[0],E=Z[1],R=Vr((0,o.useState)(""),2),_=R[0],F=R[1],M=Vr((0,o.useState)(""),2),L=M[0],B=M[1],z=Vr((0,o.useState)(!1),2),W=z[0],H=z[1],G=Vr((0,o.useState)(!1),2),$=G[0],J=G[1];(0,o.useEffect)((function(){h(t[0])}),[t.length]),(0,o.useEffect)((function(){return e.currentDriveAccount&&X(),window.addEventListener("message",K),function(){window.removeEventListener("message",K)}}),[e.currentDriveAccount]);var K=function(t){if("accountConnected"===t.data.name){var n=JSON.parse(t.data.data);e.handleDriveAccountConnected(n)}},X=function(t){x([]),C(!0),qe({accountID:e.currentDriveAccount.id,what:"folder",query:t}).then((function(e){var t=e.items?e.items:[];x(t),C(!1)}))},Q=function(e,t,r,i){if("googleDrive"===n.service){var a=new File([e],r.name,{type:t}),o=t.split("/")[1];"jpeg"==o&&(o="jpg");var s={name:r.name+"."+o};"-1"!==r.folder&&(s.parents=[r.folder]),ee(i,a,s,r.googleDriveSharable)}else if("dropbox"===n.service){var l=("-1"!==r.folder?j.filter((function(e){return e.id===r.folder}))[0].info.path||j.filter((function(e){return e.id===r.folder}))[0].info.path_lower:"")+"/"+r.name+"."+t.split("/")[1];te(i,l,e)}else if("box"===n.service){var c=r.name+"."+t.split("/")[1],u=r.folder;a=new File([e],r.name,{type:t});ne(i,a,c,u)}},ee=function(t,n,o,s){(function(e,t,n,r,i){var a=new FormData;return a.append("metadata",new Blob([JSON.stringify(n)],{type:"application/json"})),a.append("file",t),we()({url:"https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart&fields=id",method:"POST",headers:{Authorization:"Bearer "+e},data:a,onUploadProgress:function(e){if("video"===i)var t=50+Math.round(Math.round(100*e.loaded/e.total)/2);else t=Math.round(100*e.loaded/e.total);r(t)}})})(t,n,o,A,e.type).then((function(n){if(s){var a=n.data.id;J(!0),function(e,t){return we()({url:"https://www.googleapis.com/drive/v3/files/"+t+"/permissions",method:"POST",headers:{Authorization:"Bearer "+e},data:{role:"reader",type:"anyone"}})}(t,a).then((function(e){B("https://drive.google.com/file/d/".concat(a,"/view?usp=sharing")),H(!0),J(!1)})).catch((function(){B("https://drive.google.com/file/d/".concat(a,"/view?usp=sharing")),H(!0),J(!1)}))}else i.Z.success({message:Y[r].successMsg,description:(0,d.jsxs)("a",{target:"_blank",href:"https://drive.google.com/file/d/".concat(n.data.id,"/view"),children:["Click to see it in your ",Y[r].displayName]})}),e.onCancel();Ve("googleDrive")})).catch((function(e){a.ZP.error(e.response.data.msg),I(!1),A(0)}))},te=function(t,n,o){(function(e,t,n,r,i){return we()({url:"https://content.dropboxapi.com/2/files/upload",method:"POST",headers:{Authorization:"Bearer "+e,"Dropbox-API-Arg":(a={path:t,mode:"add",autorename:!0,mute:!1,strict_conflict:!1},JSON.stringify(a).replace(/[\u007f-\uffff]/g,(function(e){return"\\u"+("000"+e.charCodeAt(0).toString(16)).slice(-4)}))),"Content-Type":"application/octet-stream"},data:n,onUploadProgress:function(e){if("video"===i)var t=50+Math.round(Math.round(100*e.loaded/e.total)/2);else t=Math.round(100*e.loaded/e.total);r(t)}});var a})(t,n,o,A,e.type).then((function(t){i.Z.success({message:Y[r].successMsg,description:(0,d.jsxs)("a",{target:"_blank",href:"https://www.dropbox.com/home".concat(t.data.path_display),children:["Click to see it in your ",Y[r].displayName]})}),e.onCancel(),Ve("dropbox")})).catch((function(e){e.response&&"insufficient_space"===e.response.data.error.reason[".tag"]?a.ZP.error("Your dropbox account is full. The screenshot cant be sent to it"):a.ZP.error(e.response.data.error_summary),I(!1),A(0)}))},ne=function(t,n,o,s){(function(e,t,n,r,i,a){var o=new FormData,s={name:n};return s.parent="-1"!==r?{id:r}:{id:"0"},o.append("attributes",JSON.stringify(s)),o.append("file",t),we()({method:"POST",url:"https://upload.box.com/api/2.0/files/content",headers:{Authorization:"Bearer "+e,"Access-Control-Expose-Headers":"WWW-Authenticate"},data:o,onUploadProgress:function(e){if("video"===a)var t=50+Math.round(Math.round(100*e.loaded/e.total)/2);else t=Math.round(100*e.loaded/e.total);i(t)}})})(t,n,o,s,A,e.type).then((function(t){i.Z.success({message:Y[r].successMsg,description:(0,d.jsxs)("a",{target:"_blank",href:"https://app.box.com/file/".concat(t.data.entries[0].id),children:["Click to see it in your ",Y[r].displayName]})}),e.onCancel(),Ve("box")})).catch((function(e){if(e.response.data&&e.response.data.message)var t=e.response.data.message;else t=e.response.statusText;a.ZP.error(t),I(!1),A(0)}))},re=function(t){return e.permissions["allow".concat(Ie(t))]},ie=u()("upload-progress",{active:D}),ae=u()("drive-wrapper",{active:!D}),oe="video"===e.type?"video":"image";return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{className:"drive-panel",children:[(0,d.jsx)("div",{className:"title",children:null===n?g?"Choose your cloud storage":"":(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("div",{className:"icon ".concat(n.service)}),"Save to ",s.displayName]})}),(0,d.jsx)("div",{className:ie,children:W?(0,d.jsxs)("div",{className:"sharable-link-area",children:[(0,d.jsx)("div",{className:"label",children:"Shareable Link"}),(0,d.jsx)(Xe.Z,{value:L,style:{width:"320px"},size:"large"}),(0,d.jsx)(ue.Z,{type:"primary",size:"large",onClick:function(){Te(L),a.ZP.success("Copied!")},children:"Copy"})]}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(Qe.Z,{type:"circle",status:"active",percent:P}),(0,d.jsx)("div",{className:"upload-tip",children:P<100?"Uploading ".concat(oe,"..."):$?"Creating shareable link...":Y[r].actionTypeStr+"..."})]})}),t.length&&n?(0,d.jsx)("div",{className:ae,children:(0,d.jsx)("div",{className:"container",children:(0,d.jsxs)(Ke.Z,{onFinish:function(t){var r;I(!0),(r=n.id,Ye({method:"GET",url:"/account/token",params:{accountID:r}})).then((function(n){var r,i,a=n.token;if(e.itemUrl)(r=e.itemUrl,i=function(e){A(Math.round(e/2))},we()({method:"GET",url:r,responseType:"blob",onDownloadProgress:function(e){var t=Math.round(100*e.loaded/e.total);i&&i(t)}})).then((function(e){Q(e.data,"image/png",t,a)}));else{if(e.imageBlob)var o=e.contentType,s=e.imageBlob;else s=ke(e.imageUrl.split(",")[1]),o=e.imageUrl.split(",")[0].split(":")[1].split(";")[0];Q(s,o,t,a)}})).catch((function(e){a.ZP.error("Something went wrong!"),I(!1)}))},children:[(0,d.jsx)("div",{className:"account-select"}),(0,d.jsx)("div",{className:"label",children:"Name"}),(0,d.jsx)(Ke.Z.Item,{name:"name",rules:[{required:!0,message:"Please input a name"}],initialValue:e.tabTitle,children:(0,d.jsx)(Xe.Z,{})}),(0,d.jsx)("div",{className:"label",children:s.targetName}),(0,d.jsx)(Ke.Z.Item,{name:"folder",rules:[{required:!0,message:"choose a folder"}],initialValue:"-1",children:(0,d.jsxs)(et.Z,{showSearch:!0,placeholder:s.placeHolder,loading:S,onSearch:Jn()((function(e){X(e)}),800),filterOption:!1,children:[(0,d.jsxs)(Jr,{value:"-1",children:[(0,d.jsx)(Gr.Z,{className:"folder-option ".concat(n.service)}),"/"]}),j.map((function(e){return(0,d.jsxs)(Jr,{value:e.id,children:[(0,d.jsx)(Gr.Z,{className:"folder-option ".concat(n.service)}),"dropbox"===n.service?e.info.path||e.info.path_lower:e.name]},e.id)}))]})}),(0,d.jsx)("div",{className:"tip",children:"googleDrive"===n.service?"Only root folder and Awesome Screenshot folder are available for the moment.":"Only 10 recent folders are listed. Type and search for other folders."}),"googleDrive"===n.service&&(0,d.jsx)(Ke.Z.Item,{name:"googleDriveSharable",valuePropName:"checked",initialValue:"true"===localStorage["is-google-drive-share"],children:(0,d.jsx)(l.Z,{children:"Get shareable link (Anyone with the link can view)"})}),(0,d.jsx)(Ke.Z.Item,{children:(0,d.jsx)(ue.Z,{type:"primary",className:"upload-btn",size:"large",block:!0,htmlType:"submit",children:"Upload"})})]})})}):(0,d.jsx)(d.Fragment,{children:g?(0,d.jsx)("div",{className:"service-container",children:(0,d.jsx)("div",{className:"account-container",children:q.map((function(e){var t=u()("account-item",e.name,{pro:!re(e.name)});return(0,d.jsx)("div",{className:t,"data-des":e.name,onClick:function(){return function(e){re(e)?(m(e),y(!1)):(F(e),E(!0))}(e.name)},children:(0,d.jsx)("b",{})},e.name)}))})}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("div",{className:"top",children:(0,d.jsxs)("div",{className:"back-btn",onClick:function(){y(!0)},children:[(0,d.jsx)(N.Z,{}),"Choose another cloud storage"]})}),(0,d.jsx)("div",{className:"connect-panel",children:(0,d.jsxs)("div",{className:"box",children:[(0,d.jsxs)("div",{className:"main-box",children:[(0,d.jsx)("div",{className:"pic",children:(0,d.jsx)("div",{className:"logo ".concat(f)})}),(0,d.jsxs)("div",{className:"content",children:[(0,d.jsx)("div",{className:"logo ".concat(f)}),(0,d.jsxs)("div",{className:"title",children:["Integrate ",Y[f].displayName]}),(0,d.jsx)("div",{className:"sub-title",children:Y[f].panelSubTitle}),(0,d.jsx)("ul",{children:Y[f].featureLists.map((function(e,t){return(0,d.jsx)("li",{children:e},t)}))})]})]}),(0,d.jsxs)(ue.Z,{type:"primary",size:"large",onClick:function(){He(f).then((function(e){var t="width=800,height=700,top="+(window.screen.availHeight-30-700)/2+",left="+(window.screen.availWidth-10-800)/2;window.open(e.URI,"",t)}))},children:["Connect with",Y[f].displayName]})]})})]})})]}),(0,d.jsx)(V.Z,{visible:U,onCancel:function(){return E(!1)},type:_})]})};function Xr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Qr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Xr(Object(n),!0).forEach((function(t){ei(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Xr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ei(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ti(e){return(0,d.jsx)(r.Z,Qr(Qr({},e),{},{footer:null,maskClosable:!1,wrapClassName:"des",destroyOnClose:!0,centered:!0,children:(0,d.jsx)(Kr,Qr({},e))}))}function ni(e){var t=e.accounts;return(0,d.jsx)("div",{className:"render-drive-accounts",children:t&&t.length?(0,d.jsx)("div",{className:"save-to-drive",children:t.map((function(t){return(0,d.jsxs)("div",{className:"save-item ".concat(t.service),onClick:e.handleDriveItemClick.bind(null,t),children:[(0,d.jsx)("div",{className:"icon"}),Y[t.service].displayName," ",(0,d.jsxs)("span",{children:["(",(0,d.jsx)("span",{className:"user-email",title:t.userInfo.email,children:t.userInfo.email}),")"]})]},t.id)}))}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(ue.Z,{type:"primary",className:"connect-btn",block:!0,onClick:e.handleAddDriveClick,children:"Connect with cloud storage"}),(0,d.jsxs)("div",{className:"support-s",children:[(0,d.jsx)("div",{children:"Support:"}),(0,d.jsx)("div",{className:"s-container",children:q.map((function(e){return(0,d.jsx)(se.Z,{title:e.displayName,children:(0,d.jsx)("div",{className:"s-item ".concat(e.name)})},e.name)}))})]})]})})}function ri(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ii(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ri(Object(n),!0).forEach((function(t){ai(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ri(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ai(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const oi=function(e){var t;return(0,d.jsx)(r.Z,ii(ii({},e),{},{footer:null,maskClosable:!1,wrapClassName:"sign-in",destroyOnClose:!0,centered:!0,children:(0,d.jsxs)("div",{className:"signin-alert-modal",children:[(0,d.jsx)("div",{className:"tip",children:(t=e.type,"aws"===t?"You need to sign in to an Awesome Screenshot account in order to upload images.":"drive"===t?"You need to sign in to an Awesome Screenshot account in order to connect with cloud services.":"des"===t?"You need to sign in to an Awesome Screenshot account in order to connect with other services.":"")}),(0,d.jsx)(ue.Z,{type:"primary",size:"large",block:!0,onClick:function(){window.open("https://www.awesomescreenshot.com/signin")},children:"Sign In"})]})}))};function si(e){return(si="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function li(e){return function(e){if(Array.isArray(e))return ci(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return ci(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ci(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ci(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ui(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function di(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ui(Object(n),!0).forEach((function(t){hi(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ui(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function hi(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function pi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function fi(e,t){return(fi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function mi(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=yi(e);if(t){var i=yi(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return vi(this,n)}}function vi(e,t){return!t||"object"!==si(t)&&"function"!=typeof t?gi(e):t}function gi(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yi(e){return(yi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var bi=[{name:"save",displayName:"Download as image"},{name:"pdf",displayName:"Download as PDF"},{name:"print",displayName:"Print"},{name:"copy",displayName:"Copy"}],ji={},xi=chrome.extension.getBackgroundPage(),wi=function e(t,n){t.forEach((function(t,r){n[t.folderID]&&"0"!==t.folderID&&(t.children=n[t.folderID].map((function(e,t){return{title:e.name,value:e.folderID+"-.-"+e.name,folderID:e.folderID,icon:function(e){return e.expanded?(0,d.jsx)(de.Z,{}):(0,d.jsx)(he.Z,{})}}})),e(t.children,n))}))},Si=function(e){var t=[],n=e;return n[0]&&n[0].forEach((function(e,n){t.push({title:e.name,value:e.folderID+"-.-"+e.name,folderID:e.folderID,icon:function(e){return e.expanded?(0,d.jsx)(de.Z,{}):(0,d.jsx)(he.Z,{})}})})),t.unshift({title:"My Items",folderID:"0",value:"0-.-My Items",icon:function(e){return e.expanded?(0,d.jsx)(de.Z,{}):(0,d.jsx)(he.Z,{})}}),wi(t,e),t},Ci=function(){chrome.storage.sync.get(["clickNo"],(function(e){e.clickNo?chrome.storage.sync.set({neverShow:!0}):chrome.storage.sync.set({clickNo:!0})})),i.Z.destroy()},ki=function(e,t){i.Z.open({key:"questionnaire",className:"questionnaire",placement:"bottomRight",duration:0,style:{width:435,marginLeft:-80},message:e,description:t,onClose:Ci})},Ni=function(){Ne("https://chrome.google.com/webstore/detail/awesome-screenshot-screen/nlipoenfbbikpbjkfpfillcgkoblgpmj/reviews"),chrome.storage.sync.set({neverShow:!0}),i.Z.destroy()},Oi=function(){Ne("/feedback.html"),chrome.storage.sync.set({captureCount:0,clickNo:!0}),i.Z.destroy()},Di=function(){ki((0,d.jsx)(d.Fragment,{children:(0,d.jsx)("p",{children:"Your review means a lot to us. Would you mind taking a moment to rate the extension in the Web Store?"})}),(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(ue.Z,{style:{width:"236px",marginRight:"20px"},type:"primary",onClick:Ni,children:"Sure, take me to the Web Store."}),(0,d.jsx)(ue.Z,{style:{width:"100px"},onClick:Ci,children:"No, thanks."})]}))},Ii=function(){ki((0,d.jsx)(d.Fragment,{children:(0,d.jsx)("p",{children:"Would you like to report any issues you're experiencing or give us some suggestions so that we can make the extension better for you?"})}),(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(ue.Z,{style:{width:"256px",marginRight:"20px"},type:"primary",onClick:Oi,children:"Yes, take me to the feedback form."}),(0,d.jsx)(ue.Z,{style:{width:"100px"},onClick:Ci,children:"No, thanks."})]}))};const Ti=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fi(e,t)}(s,e);var t,n,r,i=mi(s);function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=i.call(this,e)).printIframe=(0,o.createRef)(),t.copyDiv=(0,o.createRef)(),t.img=(0,o.createRef)(),t.state={isShownSignin:!1,isShownSaveToAws:!1,isShownWhatDes:!1,isShownDrive:!1,isShownUpgrade:!1,signInLoading:!1,uploadImagePercentage:0,awsShareUrls:[],projects:[],folders:{},foldersTreeData:[],isfolderLoading:!1,destinations:[],accounts:[],isShownDes:!1,desCurrentPanel:"add",currentDes:null,driveService:"",currentDriveAccount:null,upgradeType:"",zoomImageIndex:""},t.handleLocalSave=t.handleLocalSave.bind(gi(t)),t.handleSaveToAws=t.handleSaveToAws.bind(gi(t)),t.showModal=t.showModal.bind(gi(t)),t.handleModalCancel=t.handleModalCancel.bind(gi(t)),t.handleSignInFinish=t.handleSignInFinish.bind(gi(t)),t.handleUploadFinish=t.handleUploadFinish.bind(gi(t)),t.refreshUserData=t.refreshUserData.bind(gi(t)),t.handleFolderCreated=t.handleFolderCreated.bind(gi(t)),t.openDesModal=t.openDesModal.bind(gi(t)),t.handleDesClick=t.handleDesClick.bind(gi(t)),t.goToAddDes=t.goToAddDes.bind(gi(t)),t.handleDesCreated=t.handleDesCreated.bind(gi(t)),t.handleAccountConnected=t.handleAccountConnected.bind(gi(t)),t.handleAddDriveClick=t.handleAddDriveClick.bind(gi(t)),t.handleAddDesClick=t.handleAddDesClick.bind(gi(t)),t.openDriveModal=t.openDriveModal.bind(gi(t)),t.openSetting=t.openSetting.bind(gi(t)),t.handleDriveAccountConnected=t.handleDriveAccountConnected.bind(gi(t)),t.showUpgradeModal=t.showUpgradeModal.bind(gi(t)),t.getPermissionByName=t.getPermissionByName.bind(gi(t)),t.copyUrl=t.copyUrl.bind(gi(t)),t.openFeedback=t.openFeedback.bind(gi(t)),t.openOptionPage=t.openOptionPage.bind(gi(t)),t.downloadMultiple=t.downloadMultiple.bind(gi(t)),t.downloadMultiplePDF=t.downloadMultiplePDF.bind(gi(t)),t.handleSignIn=t.handleSignIn.bind(gi(t)),t.zoomImage=t.zoomImage.bind(gi(t)),t}return t=s,(n=[{key:"componentDidMount",value:function(){var e=this;this.props.user.username&&0===this.state.projects.length&&this.refreshUserData(),chrome.runtime.onMessage.addListener((function(t,n,r){var i=t.name;"awsLoginByGoogle"===i?(e.props.refreshUser(),e.setState({isShownSignin:!1})):"stop"===i&&r()}))}},{key:"componentDidUpdate",value:function(e,t){e.user.username!==this.props.user.username&&(this.props.user.username?this.refreshUserData():this.setState({awsShareUrls:[],projects:[],destinations:[],accounts:[]})),"save"===this.props.step&&chrome.storage.sync.get(["captureCount","clickNo","neverShow"],(function(e){if(!e.neverShow){if(e.clickNo)var t=200;else t=100;e.captureCount&&e.captureCount>t&&ki("Are you enjoying Awesome Screenshot?",(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(ue.Z,{style:{width:"100px",marginRight:"20px"},onClick:Di,children:"Yes!"}),(0,d.jsx)(ue.Z,{style:{width:"100px"},onClick:Ii,children:"Not really."})]}))}}))}},{key:"copyUrl",value:function(e){Te(e)}},{key:"downloadMultiple",value:function(){var e=this.props,t=e.imageUrl,n=(e.tabTitle,e.tabUrl),r=this.props.contentType.split("/")[1];"jpeg"===r&&(r="jpg");var i=Re(n);"true"===localStorage["save-as"]?Ze().then((function(){t.forEach((function(e,t){Ue({url:e,filename:i+"_part"+(t+1)+"."+r})}))})):t.forEach((function(e,t){Ee(e,i+"_part"+(t+1)+"."+r)}))}},{key:"downloadMultiplePDF",value:function(){var e=this.props.imageUrl,t=Re(this.props.tabUrl);"true"===localStorage["save-as"]?Ze().then((function(){gt(e).then((function(e){Ue({url:e,filename:t+".pdf"})}))})):gt(e).then((function(e){Ee(e,t+".pdf")}))}},{key:"handleLocalSave",value:function(e){var t,n=this,r=this.props,i=r.imageUrl,o=r.tabTitle;if(r.tabUrl,"save"===e){var s=n.props.contentType.split("/")[1];"jpeg"==s&&(s="jpg");var l=o.replace(/(\.|\:)/g," ").replace(/[#$~\-!@%^&*();'"?><\[\]{}\|,:\/=+]/g," ")+"."+s;if(l=l.replace(/\s+/g,"-"),"true"===localStorage["save-as"]){var c={url:window.URL.createObjectURL(n.props.imageBlob),filename:l,saveAs:!0};Ze().then((function(){Ue(c)}))}else Ee(window.URL.createObjectURL(n.props.imageBlob),l)}else if("print"===e){var u=this.printIframe.current,d='<div style="margin:0 auto;text-align:center"><img style="width:100%;" src="'.concat(i,'"></div>'),h=u.contentWindow.document;h.write(d);var p=u.contentWindow;p.close(),p.focus(),p.print(),h.body.innerHTML=""}else if("copy"===e)try{var f=n.props.imageBlob;"image/jpeg"===f.type?(t=f,new Promise((function(e,n){var r=window.URL.createObjectURL(t),i=document.createElement("img"),a=document.createElement("canvas"),o=a.getContext("2d");i.onload=function(){a.width=i.width,a.height=i.height,o.drawImage(i,0,0),a.toBlob((function(t){e(t)}))},i.src=r}))).then((function(e){_e(e,(function(){a.ZP.success("Copy success!",1)}),(function(e){a.ZP.error("Copy failed.",1)}))})):_e(f,(function(){a.ZP.success("Copy success!",1)}),(function(e){a.ZP.error("Copy failed.",1)}))}catch(e){a.ZP.error("Sorry,your system doesn't support this function. Please right click on this image to save.")}else if("pdf"===e){this.props.info.width;var m=this.props.info.height,v=this.props.imageUrl,g=(this.props.tabTitle,this.props.tabUrl,14400),y=o.replace(/(\.|\:)/g," ").replace(/[#$~!@%^&*();'"?><\[\]{}\|,:\/=+-]/g," ")+".pdf";"true"===localStorage["save-as"]?Ze().then((function(){m>g?Pe(v,g,(function(e){vt(e).then((function(e){Ue({url:e,filename:y,saveAs:!0})}))})):vt([v]).then((function(e){Ue({url:e,filename:y,saveAs:!0})}))})):m>g?Pe(v,g,(function(e){vt(e).then((function(e){Ee(e,y)}))})):vt([v]).then((function(e){Ee(e,y)}))}xi.googleEvent(e+" image","local")}},{key:"handleSaveToAws",value:function(){this.props.user.username?this.showModal("SaveToAws"):this.setState({signInType:"aws",isShownSignin:!0})}},{key:"openFeedback",value:function(){var e=di({},this.props.imageInfo);localStorage.last_info=JSON.stringify(e),chrome.tabs.create({url:"/feedback.html"})}},{key:"openOptionPage",value:function(){chrome.tabs.create({url:"/option-react.html"})}},{key:"handleSignInFinish",value:function(){this.handleModalCancel("Signin"),this.props.refreshUser()}},{key:"handleUploadFinish",value:function(e){this.setState({isShownSaveToAws:!1,awsShareUrls:[].concat(li(this.state.awsShareUrls),[e])})}},{key:"showModal",value:function(e){var t="isShown".concat(e);this.setState(hi({},t,!0))}},{key:"openSetting",value:function(e){chrome.tabs.create({url:"https://www.awesomescreenshot.com/settings/"+e})}},{key:"handleModalCancel",value:function(e){var t,n="isShown".concat(e);this.setState((hi(t={},n,!1),hi(t,"signInType",""),t))}},{key:"goToAddDes",value:function(){this.setState({desCurrentPanel:"add"})}},{key:"handleDesCreated",value:function(e){this.setState({destinations:[].concat(li(this.state.destinations),[e]),desCurrentPanel:"des",currentDes:e})}},{key:"openDesModal",value:function(e){var t=this;this.setState({desCurrentPanel:e},(function(){t.showModal("Des")}))}},{key:"getPermissionByName",value:function(e){return this.props.permissions["allow".concat(Ie(e))]}},{key:"goToRate",value:function(){Ne("https://chrome.google.com/webstore/detail/awesome-screenshot-screen/nlipoenfbbikpbjkfpfillcgkoblgpmj/reviews")}},{key:"handleDesClick",value:function(e){var t=this;"add"===e?this.openDesModal("add"):this.getPermissionByName(e.service)?this.setState({currentDes:e},(function(){t.openDesModal("des")})):this.setState({upgradeType:"des",isShownUpgrade:!0})}},{key:"handleSignOut",value:function(){Ne("https://www.awesomescreenshot.com/web/user/logout")}},{key:"handleFolderCreated",value:function(e){var t={};t=this.state.folders[0]?di(di({},this.state.folders),{},{0:[e].concat(li(this.state.folders[0]))}):{0:[e]};var n=Si(t);this.setState({folders:t,foldersTreeData:n})}},{key:"openDriveModal",value:function(e){var t=this;this.props.user.username?this.props.permissions["allow".concat(Ie(e.service))]?this.setState({currentDriveAccount:e},(function(){t.showModal("Drive")})):this.setState({upgradeType:e.service},(function(){t.showModal("Upgrade")})):this.setState({signInType:"drive",isShownSignin:!0})}},{key:"refreshUserData",value:function(){var e,t=this;this.setState({projects:[],destinations:[],isShownSignin:!1,isfolderLoading:!0}),Ye({method:"GET",url:"/folder/load_user_folders",params:{count:20,page:e}}).then((function(e){var n=e.folders,r=Si(n);t.setState({folders:n,foldersTreeData:r,isfolderLoading:!1})})),Promise.all([Ye({method:"GET",url:"/account/load"}),Ye({method:"GET",url:"/destination/load"})]).then((function(e){t.setState({accounts:e[0].accounts?e[0].accounts:[],destinations:e[1].destinations?e[1].destinations:[]}),e[0].accounts&&(ji={},e[0].accounts.forEach((function(e){ji[e.id]=e})))})).catch((function(e){}))}},{key:"handleAccountConnected",value:function(e){this.setState({accounts:[].concat(li(this.state.accounts),[e]),currentAccount:e},(function(){ji[e.id]=e}))}},{key:"handleDriveAccountConnected",value:function(e){this.setState({accounts:[e].concat(li(this.state.accounts)),currentDriveAccount:e})}},{key:"handleAddDesClick",value:function(){this.props.user.username?this.showModal("Des"):this.setState({signInType:"des",isShownSignin:!0})}},{key:"handleAddDriveClick",value:function(){var e=this;this.props.user.username?this.setState({currentDriveAccount:null},(function(){e.showModal("Drive")})):this.setState({signInType:"drive",isShownSignin:!0})}},{key:"showUpgradeModal",value:function(e){this.setState({isShownUpgrade:!0,driveService:e})}},{key:"zoomImage",value:function(e){this.setState({zoomImageIndex:e})}},{key:"handleSignIn",value:function(){window.open("https://www.awesomescreenshot.com/signin")}},{key:"render",value:function(){var e=this,t=Oe(this.props.imageUrl),n=this.state,r=n.awsShareUrls,i=n.destinations,a=this.props.user,o=this.state.accounts.filter((function(e){return"googleDrive"===e.service||"dropbox"===e.service||"box"===e.service})),s=this.state.accounts.filter((function(e){return"googleDrive"!==e.service&&"dropbox"!==e.service&&"box"!==e.service})),l=u()("save-panel",this.props.className),c=(0,d.jsxs)(ce.Z,{children:["free"===this.props.currentPlan.PlanName&&(0,d.jsx)(ce.Z.Item,{children:(0,d.jsxs)("a",{href:"https://www.awesomescreenshot.com/pricing",target:"_blank",rel:"noopener noreferrer",children:[(0,d.jsx)(pe.Z,{style:{marginRight:"5px"},title:"Premium user"}),"Upgrade"]})}),(0,d.jsx)(ce.Z.Item,{onClick:this.handleSignOut,children:(0,d.jsxs)("a",{children:[(0,d.jsx)(fe.Z,{style:{marginRight:"5px"}}),"Sign out"]})})]}),h=function(e,t,n){return(0,d.jsxs)("div",{className:"section",children:[e&&(0,d.jsxs)("div",{className:"section-title",children:[t&&(0,d.jsx)("div",{className:"icon "+t}),e]}),(0,d.jsx)("div",{className:"section-content",children:n})]})};return(0,d.jsxs)("div",{className:l,children:[(0,d.jsx)("iframe",{className:"print-iframe",ref:this.printIframe,frameBorder:"0"}),(0,d.jsx)("div",{className:"copy-div",contentEditable:"true",ref:this.copyDiv}),(0,d.jsx)("div",{className:"top-bar",children:(0,d.jsxs)("div",{className:"inner-container",children:[(0,d.jsxs)("div",{className:"logo-area",children:[(0,d.jsx)("div",{className:"logo"}),(0,d.jsx)("a",hi({target:"_blank",href:"https://www.awesomescreenshot.com"},"target","_blank"))]}),(0,d.jsxs)("div",{className:"user-area",children:[this.props.isReported||"entire"!==this.props.menuType&&"selected"!==this.props.menuType?(0,d.jsx)("div",{}):(0,d.jsxs)("div",{className:"quick-issue",children:["Not properly captured?",(0,d.jsx)("a",{onClick:this.props.quickReport,children:" Report a problem."})]}),(0,d.jsxs)("a",{className:"user-link email-us",target:"_blank",onClick:this.openOptionPage,children:[(0,d.jsx)(me.Z,{}),"Options"]}),(0,d.jsxs)("a",{className:"user-link email-us",target:"_blank",onClick:this.openFeedback,children:[(0,d.jsx)(ve.Z,{}),"Send Feedback"]}),a.username?(0,d.jsx)(le.Z,{overlay:c,trigger:["click"],placement:"bottomRight",children:(0,d.jsxs)("div",{className:"user-link",children:["free"!==this.props.currentPlan.PlanName&&this.props.currentPlan.PlanName?(0,d.jsx)(ye.Z,{style:{color:"#faad14"}}):(0,d.jsx)(ge.Z,{}),a.username,(0,d.jsx)(be.Z,{})]})}):(0,d.jsxs)("div",{className:"user-link",onClick:this.handleSignIn,children:[(0,d.jsx)(ge.Z,{}),"Sign in"]})]})]})}),(0,d.jsx)("div",{className:"panel",children:(0,d.jsxs)("div",{className:"inner-container",children:[(0,d.jsxs)("div",{className:"left",children:[!t&&(0,d.jsx)(se.Z,{mouseEnterDelay:.3,title:"Back and Re-edit this screenshot",children:(0,d.jsx)("div",{className:"back-btn",onClick:this.props.backToEdit,children:(0,d.jsx)("b",{})})}),(0,d.jsx)("div",{className:"image-container",children:Oe(e.props.imageUrl)?e.props.imageUrl.map((function(t,n){var r=e.state.zoomImageIndex===n,i=r?"zoom-in":"";return(0,d.jsx)("img",{className:"multiple ".concat(i),src:t,ref:e.img,alt:"",onClick:function(){e.zoomImage(r?"":n)}},n)})):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("span",{className:"helper"}),(0,d.jsx)("img",{src:e.props.imageUrl,ref:e.img,alt:""})]})})]}),(0,d.jsxs)("div",{className:"right",children:[(0,d.jsxs)("div",{className:"panel-logo-area",children:[(0,d.jsx)("div",{className:"logo"}),"AwesomeScreenshot"]}),(0,d.jsx)("div",{className:"right-container",children:t?(0,d.jsx)("div",{className:"multiple-image-panel sub-panel",children:(0,d.jsxs)("div",{className:"section",children:[(0,d.jsxs)("div",{className:"tip",children:["Note: there's no way for Chrome to capture this web page as a single image because it is too large, and editing toolbar is not available in this situation. The screenshot was automatically split into"," ",this.props.imageUrl.length," images. You can download all images or save images as a single PDF with one click."]}),(0,d.jsxs)("div",{className:"btn-area",children:[(0,d.jsx)(ue.Z,{block:!0,className:"multiple-download-btn",onClick:this.downloadMultiple,children:"Download all ".concat(this.props.imageUrl.length," images")}),(0,d.jsx)(ue.Z,{block:!0,className:"multiple-download-btn",onClick:this.downloadMultiplePDF,children:"Download as PDF"})]})]})}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("div",{className:"local-panel",children:(0,d.jsx)("div",{className:"local-save-container",children:bi.map((function(t){var n=u()("local-save-item",t.name);return(0,d.jsx)(se.Z,{mouseEnterDelay:.3,title:t.displayName,children:(0,d.jsx)("div",{className:n,onClick:e.handleLocalSave.bind(null,t.name),children:(0,d.jsx)("b",{})})},t.name)}))})}),(0,d.jsx)("div",{className:"sub-panel",children:h("Save to Awesome Screenshot","",(0,d.jsx)(d.Fragment,{children:r.length?(0,d.jsxs)("div",{className:"aws-share-area",children:[r.map((function(t){return(0,d.jsxs)("div",{className:"aws-share-item",children:[(0,d.jsxs)("div",{className:"title",children:["Saved in"," ",(0,d.jsx)("span",{title:t.projectName,children:t.projectName})]}),(0,d.jsxs)("div",{className:"input-area",children:[(0,d.jsx)("input",{type:"text",value:t.url,readOnly:!0}),(0,d.jsx)(se.Z,{title:"copied!",trigger:"click",children:(0,d.jsx)("div",{className:"aws-share-action-btn",onClick:e.copyUrl.bind(null,t.url),children:(0,d.jsx)(je.Z,{})})})]})]},t.projectId)})),(0,d.jsx)("div",{className:"save-another",onClick:this.handleSaveToAws,children:"Save to another folder"})]}):(0,d.jsx)(ue.Z,{className:"save-aws-btn",onClick:this.handleSaveToAws,block:!0,children:"Upload to get shareable link"})}))}),(0,d.jsx)("div",{className:"sub-panel",children:h((0,d.jsxs)(d.Fragment,{children:["Collaborate with Teammates",0!==i.length&&(0,d.jsx)("div",{className:"actions",children:(0,d.jsx)(se.Z,{title:"Manage destinations",children:(0,d.jsx)("div",{className:"action-btn option",onClick:this.openSetting.bind(null,"destinations")})})})]}),"",(0,d.jsx)(qr,{destinations:i,handleDesClick:this.handleDesClick,handleAddDesClick:this.handleAddDesClick,small:!0}))}),(0,d.jsx)("div",{className:"sub-panel",children:h((0,d.jsxs)(d.Fragment,{children:["Save to Cloud",0!==o.length&&(0,d.jsxs)("div",{className:"actions",children:[(0,d.jsx)(se.Z,{title:"Connect a new account",children:(0,d.jsx)("div",{className:"action-btn add",onClick:this.handleAddDriveClick})}),(0,d.jsx)(se.Z,{title:"Manage accounts",children:(0,d.jsx)("div",{className:"action-btn option",onClick:this.openSetting.bind(null,"connectedAccounts")})})]})]}),"",(0,d.jsx)(d.Fragment,{children:(0,d.jsx)("div",{className:"save-to-drive",children:(0,d.jsx)(ni,{accounts:o,handleAddDriveClick:this.handleAddDriveClick,handleDriveItemClick:this.openDriveModal})})}))})]})})]})]})}),(0,d.jsx)("div",{className:"footer",children:(0,d.jsx)("div",{className:"inner-container",children:(0,d.jsx)("div",{className:"social-media"})})}),(0,d.jsx)(oi,{visible:this.state.isShownSignin,onCancel:this.handleModalCancel.bind(null,"Signin"),type:this.state.signInType}),(0,d.jsx)(ft,{visible:this.state.isShownSaveToAws,onCancel:this.handleModalCancel.bind(null,"SaveToAws"),tabTitle:this.props.tabTitle,imageUrl:this.props.imageUrl,imageBlob:this.props.imageBlob,contentType:this.props.contentType,img:this.img.current,folders:this.state.folders,foldersTreeData:this.state.foldersTreeData,onUploadFinish:this.handleUploadFinish,onRefreshProjects:this.refreshUserData,onFolderCreated:this.handleFolderCreated,currentPlan:this.props.currentPlan,counts:this.props.counts,isfolderLoading:this.state.isfolderLoading}),(0,d.jsx)(Br,{visible:this.state.isShownDes,onCancel:this.handleModalCancel.bind(null,"Des"),currentPanel:this.state.desCurrentPanel,currentDes:this.state.currentDes,accountHash:ji,destinations:this.state.destinations,accounts:s,tabTitle:this.props.tabTitle,tabUrl:this.props.tabUrl,imageUrl:this.props.imageUrl,imageBlob:this.props.imageBlob,goToAddDes:this.goToAddDes,handleDesCreated:this.handleDesCreated,handleAccountConnected:this.handleAccountConnected,imageInfo:this.props.imageInfo,permissions:this.props.permissions,currentPlan:this.props.currentPlan,contentType:this.props.contentType}),(0,d.jsx)(ti,{visible:this.state.isShownDrive,onCancel:this.handleModalCancel.bind(null,"Drive"),tabTitle:this.props.tabTitle,imageUrl:this.props.imageUrl,imageBlob:this.props.imageBlob,service:this.state.driveService,permissions:this.props.permissions,currentPlan:this.props.currentPlan,accounts:o,currentDriveAccount:this.state.currentDriveAccount,handleDriveAccountConnected:this.handleDriveAccountConnected,contentType:this.props.contentType,showUpgradeModal:this.showUpgradeModal}),(0,d.jsx)(V.Z,{visible:this.state.isShownUpgrade,onCancel:this.handleModalCancel.bind(null,"Upgrade"),type:this.state.upgradeType}),(0,d.jsx)(Hr,{visible:this.state.isShownWhatDes,onCancel:this.handleModalCancel.bind(null,"WhatDes")})]})}}])&&pi(t.prototype,n),r&&pi(t,r),s}(o.Component);var Pi=3e4;function Ai(e,t,n,r,i){var a=i||Pi,o=e[0].width/n,s=e[0].height/n,l=Math.ceil(s*t);if(l)var c=(e.length-1)*s+l;else c=e.length*s;for(var u=Math.ceil(c/a),d=c%a,h=0,p=0,f=[],m=0,v=0;v<u;v++){var g=document.createElement("canvas"),y=g.getContext("2d");g.id="c_"+v,g.width=o,g.height=v===u-1?d:a;for(var b=h;b<e.length;b++){var j=0,x=o*n,w=s*n,S=o,C=s;if(b===e.length-1&&v===u-1?j=m?(s-Math.min(m,l))*n:(s-l)*n:(m&&(j=(s-m)*n,w=(C=m)*n),b===e.length-1&&v!==u-1&&(j=(s-l)*n)),y.drawImage(e[b],0,j,x,w,0,p,S,C),p+C>a){h=b,m=b===e.length-1&&v+1===u-1?p+l-a:p+s-a,p=0;break}p=m?p+m:p+C,m=0}!function(e){g.toBlob((function(t){if(f.push({blob:t,index:e}),f.length===u){f.sort((function(e,t){return e.index-t.index}));r(f.map((function(e){return e.blob})))}}))}(v)}}function Zi(){var e=document.createElement("p");e.style.width="100%",e.style.height="200px";var t=document.createElement("div");t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.visibility="hidden",t.style.width="200px",t.style.height="150px",t.style.overflow="hidden",t.appendChild(e),document.body.appendChild(t);var n=e.offsetWidth;t.style.overflow="scroll";var r=e.offsetWidth;return n==r&&(r=t.clientWidth),document.body.removeChild(t),n-r}window.requestFileSystem=window.requestFileSystem||window.webkitRequestFileSystem;var Ui=null;function Ei(e){var t="";switch(e.code){case FileError.QUOTA_EXCEEDED_ERR:t="QUOTA_EXCEEDED_ERR";break;case FileError.NOT_FOUND_ERR:t="NOT_FOUND_ERR";break;case FileError.SECURITY_ERR:t="SECURITY_ERR";break;case FileError.INVALID_MODIFICATION_ERR:t="INVALID_MODIFICATION_ERR";break;case FileError.INVALID_STATE_ERR:t="INVALID_STATE_ERR";break;default:t="Unknown Error"}return t}const Ri={fs:null,getFs:function(){return new Promise((function(e,t){window.requestFileSystem(window.PERSISTENT,52428800,(function(t){e(t)}),(function(e){t(e)}))}))},save:function(e,t){var n=this;return this.getFs().then((function(r){return n.do_save(r,e,t)}),Ei)},append:function(e,t){Ui?Ui.write(e):this.getFs().then((function(n){n.root.getFile(t,{create:!1},(function(t){t.createWriter((function(t){t.onwriteend=function(e){},t.onerror=function(e){},t.write(e),Ui=t}),(function(e){}))}),(function(e){}))}))},do_save:function(e,t,n){return new Promise((function(r,i){e.root.getFile(n,{create:!0},(function(e){e.createWriter((function(n){n.onwriteend=function(t){r(e.toURL())},n.onerror=function(e){i(e.toString())},n.write(t),Ui=n}),(function(e){i(e)}))}),(function(e){i(e)}))}))},getFile:function(e){var t=this;return new Promise((function(n,r){t.getFs().then((function(t){t.root.getFile(e,{},(function(e){e.file((function(e){n(e)}),r)}),r)}))}))}};var _i=n(31795),Fi=n.n(_i);function Mi(e){return(Mi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Li(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Bi(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Li(Object(n),!0).forEach((function(t){zi(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Li(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function zi(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Yi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Wi(e,t){return(Wi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Hi(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Vi(e);if(t){var i=Vi(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return qi(this,n)}}function qi(e,t){return!t||"object"!==Mi(t)&&"function"!=typeof t?Gi(e):t}function Gi(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Vi(e){return(Vi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var $i=chrome.extension.getBackgroundPage(),Ji={Browser:Fi().name+" "+Fi().version,OS:Fi().os.toString(),"Screen Size":window.screen.width+"x"+window.screen.height,"Viewport Size":window.innerWidth+"x"+window.innerHeight,"Pixel Ratio":"@"+window.devicePixelRatio+"x","Zoom Level":100*$i.zoomLevel+"%"},Ki=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Wi(e,t)}(l,e);var t,n,o,s=Hi(l);function l(e){var t,n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=s.call(this,e)).state={tabTitle:$i.tabtitle,tabUrl:$i.taburl,annotateImageUrl:"",saveImageUrl:"",imageBlob:null,info:{},contentType:(n=localStorage.format,"jpg"===n?"image/jpeg":"image/png"),user:{username:"",userType:0,userEmail:"",premiumLevel:""},permissions:{},currentPlan:{},counts:{},step:"edit",isAddDateAndURL:!1,isReported:!1,menuType:$i.menuType},t.enterSave=t.enterSave.bind(Gi(t)),t.backToEdit=t.backToEdit.bind(Gi(t)),t.refreshUser=t.refreshUser.bind(Gi(t)),t.quickReportIssueUrl=t.quickReportIssueUrl.bind(Gi(t)),t.reportIssueUrl=t.reportIssueUrl.bind(Gi(t)),t}return t=l,(n=[{key:"componentDidMount",value:function(){var e=this,t=this.Bg=chrome.extension.getBackgroundPage(),n=localStorage.fileUrls?JSON.parse(localStorage.fileUrls):null,r=t.menuType,i=t.type,a=t.dataURL,o=void 0!==localStorage["after-capture-action"]?localStorage["after-capture-action"]:"true"===localStorage["skip-annotate"]?"skipEntireCapture":"annotate";if(a.length){var s="true"===localStorage["resize-for-retina"];!function(e,t,n,r,i,a,o,s,l,c,u,d,h,p){var f,m,v,g,y,b,j,x,w=1,S=document.createElement("canvas"),C=S.getContext("2d"),k=h?Zi():0,N=0,O=0;function D(){S.width=v,S.height=g}switch(d&&window.devicePixelRatio>1&&(w=window.devicePixelRatio),f=c[0].width/w,m=c[0].height/w,j=c[0].width,x=c[0].height,t){case"visible":"selected"===e?(v=i/w,g=a/w,R=n,M=r,x=a,j=i):"desktop"===e||"upload"===e?(v=f,g=m,R=0,M=0):(v=f-k*window.devicePixelRatio,g=m,R=0,M=0,j-=k*window.devicePixelRatio),D(),C.drawImage(c[0],R,M,j,x,0,0,v,g),"jpg"===u?S.toBlob((function(e){p(e,{width:S.width,height:S.height})}),"image/jpeg",1):S.toBlob((function(e){p(e,{width:S.width,height:S.height})}));break;case"entire":var I=O=N=0,T=c.length,P=o,A=Math.round(T/P),Z=function e(t,n,r,i,a,o,s,l,d){t?(s=I*m,I==A-1&&(r=(m-y)*w,a=(d=y)*w),C.drawImage(t,n,r,i,a,o,s,l,d),++I>A-1&&E(),e(c[++N],n,r,i,a,o,s,l,d)):"jpg"===u?S.toBlob((function(e){p(e,{width:S.width,height:S.height})}),"image/jpeg",1):S.toBlob((function(e){p(e,{width:S.width,height:S.height})}))},U=function e(t,n,r,i,a,o,s,l,u,d){o=O*f,O==P-1&&(n=f-b,l=b),C.drawImage(t,n,r,i,a,o,s,l,u),O<P-1&&e(c[++O],n,r,i,a,o,s,l,u)},E=function(){++O>P-1||(O==P-1?(R=f-b,_=v-O*f,F=O*f):(R=0,_=f,F=O*f),M=0,L=m,B=0,Z(c[N=(I=0)+O*A],R,M,j,x,F,B,_,L))};if(!l.x&&l.y){if(A=T,y=m*s.y,v="selected"==e?i/w:f,(g=y?m*(A-1)+y:m*A)>Pi)return void Ai(c,s.y,w,p);D();var R=0,_=f,F=0,M=0,L=m,B=0;"selected"==e&&n&&(R=n),Z(c[N],R,M,j,x,F,B,_,L)}l.x&&!l.y&&(P=T,b=f*s.x,g="selected"==e?request.centerH:m,v=b?f*(P-1)+b:f*P,D(),R=0,_=f,F=0,M=0,L=m,B=0,U(c[N],R,M,j,x,F,B,_,L)),l.x&&l.y&&(b=f*s.x,y=m*s.y,"selected"==e?(v=request.centerW,g=request.centerH):(v=b?f*(P-1)+b:f*P,g=y?m*(A-1)+y:m*A),D(),R=0,_=f,F=0,M=0,L=m,B=0,Z(c[N],R,M,j,x,F,B,_,L))}}(r,i,t.centerOffX,t.centerOffY,t.centerW,t.centerH,t.counter,t.ratio,t.scrollBar,a,localStorage.format,s,t.contentCanScroll,(function(n,i){if(Oe(n))var a=n.map((function(e){return URL.createObjectURL(e)}));else a=URL.createObjectURL(n);var s="skipAnnotate"===o||("skipEntireCapture"===o||"true"===localStorage["skip-annotate"])&&"entire"===r||Oe(n);if(s)if("true"!==localStorage["add-url"]||Oe(n)){var l={saveImageUrl:a,imageBlob:n,step:s?"save":"edit"};Oe(n)||setTimeout((function(){var t=new FileReader;t.readAsDataURL(n),t.onloadend=function(){var n=t.result;e.setState({saveImageUrl:n},(function(){t=null}))}}),1200)}else a="desktop"===t.menuType?"":e.state.tabUrl,Fe(n,i,a,(function(t){var n=t,r=URL.createObjectURL(n);e.setState({imageBlob:n,saveImageUrl:r,info:i,isAddDateAndURL:!0,step:"save"}),setTimeout((function(){var e=new FileReader;e.readAsDataURL(n),e.onloadend=function(){var t=e.result;that.setState({saveImageUrl:t},(function(){e=null}))}}),1200)}));else l={annotateImageUrl:a};e.setState(l),setTimeout((function(){var e=Oe(n)?n:[n],t=[];e.forEach((function(n,r){Ri.save(n,"currentScreenshot"+r+".png").then((function(n){t.push({url:n,index:r}),t.length===e.length&&(t.sort((function(e,t){return e.index-t.index})),localStorage.fileUrls=JSON.stringify(t.map((function(e){return e.url}))),chrome.runtime.sendMessage({action:"clearDataURL"}))}))}))}),1e3)}))}else if(n&&!a.length){if("skipAnnotate"===o||("skipEntireCapture"===o||"true"===localStorage["skip-annotate"])&&"entire"===i||n.length>1)var l={saveImageUrl:n.length>1?n:n[0],step:"save"};else l={annotateImageUrl:n[0]};this.setState(l)}e.refreshUser(),document.addEventListener("visibilitychange",(function(){"visible"===document.visibilityState&&e.refreshUser()})),chrome.storage.sync.get(["captureCount"],(function(e){e.captureCount?chrome.storage.sync.set({captureCount:e.captureCount+1}):chrome.storage.sync.set({captureCount:1})}))}},{key:"componentWillUnmount",value:function(){document.removeEventListener("visibilitychange",(function(){"visible"===document.visibilityState&&z.refreshUser()}))}},{key:"reportIssueUrl",value:function(){var e=this;if(this.state.isReported)a.ZP.warning("You have reported a problem with this page successfully.");else{var t={};t["Extension Version"]=chrome.runtime.getManifest().version,localStorage.last_info&&(t=Bi(Bi({},t),JSON.parse(localStorage.last_info))),t.Browser||(t.Browser=Fi().name+" "+Fi().version),t.OS||(t.OS=Fi().os.toString()),t["Screen Size"]||(t["Screen Size"]=window.screen.width+"x"+window.screen.height);var n={name:this.state.user.username?this.state.user.username:"user",subject:"Full Page capture Iusse",content:function(e,t){var n="";for(var r in n+=e+"<br/><br/><br/><hr>",t)n+="<b>"+r+"</b>: "+t[r]+"<br/>";return n}(this.state.tabTitle+" "+this.state.tabUrl+"\nmenuType: "+$i.menuType,t)};this.state.user.userEmail&&!/privaterelay.appleid.com/.test(this.state.user.userEmail)?n.email=this.state.user.userEmail:n.email="report_fullpage@aws.cn",function(e){return Ye({method:"POST",url:"/common/contact_us",data:e})}(n).then((function(t){e.setState({isReported:!0}),i.Z.open({message:"Thank you :)",description:"Your report has been sent successfully. We will look into this and find a solution as soon as possible.",duration:2})})).catch((function(e){a.ZP.warning("Submission failed. Please retry or copy the page's url to send an email to care@awesomescreenshot.com.")}))}}},{key:"quickReportIssueUrl",value:function(){var e=this;r.Z.confirm({title:"Not properly captured?",onOk:function(){e.reportIssueUrl()},okText:"Report",okType:"primary"})}},{key:"refreshUser",value:function(){var e=this;We().then((function(t){t?t.username===e.state.user.username&&t.type===e.state.user.userType&&t.mail===e.state.user.userEmail&&t.premiumLevel===e.state.user.premiumLevel||(e.setState({user:{username:t.username,userType:t.type,userEmail:t.mail,premiumLevel:t.premiumLevel}}),Ye({method:"GET",url:"/user/info"}).then((function(t){e.setState({permissions:t.permissions,currentPlan:t.premium.currentPlan,counts:t.counts})}))):e.setState({user:{username:"",userType:0,userEmail:""},permissions:{}})}))}},{key:"enterSave",value:function(e,t,n){var r=this;if(window.location.href.match(/gmail=(.*)/)){var i=parseInt(window.location.href.match(/gmail=(.*)/)[1]),a=new FileReader;return a.readAsDataURL(t),void(a.onloadend=function(){var e=a.result;chrome.tabs.sendMessage(i,{action:"insertImage",dataURL:e}),setTimeout((function(){window.close()}),0)})}"true"!==localStorage["add-url"]||r.state.isAddDateAndURL?(r.setState({imageBlob:t,saveImageUrl:e,info:n,step:"save"}),setTimeout((function(){var e=new FileReader;e.readAsDataURL(t),e.onloadend=function(){var t=e.result;r.setState({saveImageUrl:t},(function(){e=null}))}}),1200)):(e="desktop"===$i.menuType?"":this.state.tabUrl,Fe(t,n,e,(function(e){var t=e,i=URL.createObjectURL(t);r.setState({imageBlob:t,saveImageUrl:i,info:n,step:"save"}),setTimeout((function(){var e=new FileReader;e.readAsDataURL(t),e.onloadend=function(){var t=e.result;r.setState({saveImageUrl:t},(function(){e=null}))}}),1200)})))}},{key:"backToEdit",value:function(){var e={step:"edit"};this.state.annotateImageUrl||(e.annotateImageUrl=this.state.saveImageUrl),this.setState(e)}},{key:"render",value:function(){var e=u()("sub-page",{active:"edit"===this.state.step}),t=u()("sub-page",{active:"save"===this.state.step});return chrome.extension.getBackgroundPage(),this.state.saveImageUrl||this.state.annotateImageUrl?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(oe,{imageUrl:this.state.annotateImageUrl,handleFinishEdit:this.enterSave,permissions:this.state.permissions,className:e,type:"ext",contentType:this.state.contentType,isReported:this.state.isReported,menuType:this.state.menuType,quickReport:this.quickReportIssueUrl}),(0,d.jsx)(Ti,{user:this.state.user,backToEdit:this.backToEdit,imageUrl:this.state.saveImageUrl,imageBlob:this.state.imageBlob,tabTitle:this.state.tabTitle,tabUrl:this.state.tabUrl,info:this.state.info,imageInfo:Ji,refreshUser:this.refreshUser,step:this.state.step,className:t,permissions:this.state.permissions,currentPlan:this.state.currentPlan,contentType:this.state.contentType,isReported:this.state.isReported,menuType:this.state.menuType,quickReport:this.quickReportIssueUrl,counts:this.state.counts})]}):(0,d.jsx)("div",{className:"loading-page",children:(0,d.jsxs)("div",{className:"center",children:[(0,d.jsx)("div",{className:"loading-spinner",children:(0,d.jsxs)("div",{className:"spinner",children:[(0,d.jsx)("div",{className:"rect1"}),(0,d.jsx)("div",{className:"rect2"}),(0,d.jsx)("div",{className:"rect3"}),(0,d.jsx)("div",{className:"rect4"}),(0,d.jsx)("div",{className:"rect5"})]})}),(0,d.jsxs)("div",{className:"brand",children:[(0,d.jsx)("div",{className:"logo"}),"AWESOME SCREENSHOT"]})]})})}}])&&Yi(t.prototype,n),o&&Yi(t,o),l}(o.Component);s.render((0,d.jsx)(Ki,{}),document.getElementById("edit-page"))}},o={};function s(e){var t=o[e];if(void 0!==t)return t.exports;var n=o[e]={id:e,loaded:!1,exports:{}};return a[e].call(n.exports,n,n.exports,s),n.loaded=!0,n.exports}s.m=a,e=[],s.O=(t,n,r,i)=>{if(!n){var a=1/0;for(c=0;c<e.length;c++){for(var[n,r,i]=e[c],o=!0,l=0;l<n.length;l++)(!1&i||a>=i)&&Object.keys(s.O).every((e=>s.O[e](n[l])))?n.splice(l--,1):(o=!1,i<a&&(a=i));o&&(e.splice(c--,1),t=r())}return t}i=i||0;for(var c=e.length;c>0&&e[c-1][2]>i;c--)e[c]=e[c-1];e[c]=[n,r,i]},s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},n=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,s.t=function(e,r){if(1&r&&(e=this(e)),8&r)return e;if("object"==typeof e&&e){if(4&r&&e.__esModule)return e;if(16&r&&"function"==typeof e.then)return e}var i=Object.create(null);s.r(i);var a={};t=t||[null,n({}),n([]),n(n)];for(var o=2&r&&e;"object"==typeof o&&!~t.indexOf(o);o=n(o))Object.getOwnPropertyNames(o).forEach((t=>a[t]=()=>e[t]));return a.default=()=>e,s.d(i,a),i},s.d=(e,t)=>{for(var n in t)s.o(t,n)&&!s.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},s.f={},s.e=e=>Promise.all(Object.keys(s.f).reduce(((t,n)=>(s.f[n](e,t),t)),[])),s.u=e=>"javascripts/bundles/"+e+".bundle.js",s.miniCssF=e=>"stylesheets/bundles/"+e+".bundle.css",s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r={},i="AwesomeScreenshot:",s.l=(e,t,n,a)=>{if(r[e])r[e].push(t);else{var o,l;if(void 0!==n)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var d=c[u];if(d.getAttribute("src")==e||d.getAttribute("data-webpack")==i+n){o=d;break}}o||(l=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,s.nc&&o.setAttribute("nonce",s.nc),o.setAttribute("data-webpack",i+n),o.src=e),r[e]=[t];var h=(t,n)=>{o.onerror=o.onload=null,clearTimeout(p);var i=r[e];if(delete r[e],o.parentNode&&o.parentNode.removeChild(o),i&&i.forEach((e=>e(n))),t)return t(n)},p=setTimeout(h.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=h.bind(null,o.onerror),o.onload=h.bind(null,o.onload),l&&document.head.appendChild(o)}},s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{var e;s.g.importScripts&&(e=s.g.location+"");var t=s.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");n.length&&(e=n[n.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),s.p=e+"../../"})(),(()=>{var e={922:0};s.f.j=(t,n)=>{var r=s.o(e,t)?e[t]:void 0;if(0!==r)if(r)n.push(r[2]);else{var i=new Promise(((n,i)=>r=e[t]=[n,i]));n.push(r[2]=i);var a=s.p+s.u(t),o=new Error;s.l(a,(n=>{if(s.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var i=n&&("load"===n.type?"missing":n.type),a=n&&n.target&&n.target.src;o.message="Loading chunk "+t+" failed.\n("+i+": "+a+")",o.name="ChunkLoadError",o.type=i,o.request=a,r[1](o)}}),"chunk-"+t,t)}},s.O.j=t=>0===e[t];var t=(t,n)=>{var r,i,[a,o,l]=n,c=0;for(r in o)s.o(o,r)&&(s.m[r]=o[r]);for(l&&l(s),t&&t(n);c<a.length;c++)i=a[c],s.o(e,i)&&e[i]&&e[i][0](),e[a[c]]=0;s.O()},n=self.webpackChunkAwesomeScreenshot=self.webpackChunkAwesomeScreenshot||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),s.O(void 0,[394,377,238,103,514,499,951,224,891,473,989,366],(()=>s(11008)));var l=s.O(void 0,[394,377,238,103,514,499,951,224,891,473,989,366],(()=>s(65207)));l=s.O(l)})();